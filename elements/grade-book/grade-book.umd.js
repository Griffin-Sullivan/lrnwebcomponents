!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@lrnwebcomponents/simple-popover/simple-popover.js"),require("@lrnwebcomponents/md-block/md-block.js"),require("@lrnwebcomponents/video-player/video-player.js"),require("@lrnwebcomponents/csv-render/csv-render.js"),require("lit-element/lit-element.js"),require("@lrnwebcomponents/simple-colors/simple-colors.js"),require("@lrnwebcomponents/i18n-manager/lib/I18NMixin.js"),require("@lrnwebcomponents/utils/utils.js"),require("@lrnwebcomponents/utils/lib/gSheetsInterface.js"),require("@lrnwebcomponents/simple-fields/lib/simple-fields-field.js"),require("@lrnwebcomponents/simple-fields/lib/simple-fields-tag-list.js"),require("@lrnwebcomponents/a11y-collapse/a11y-collapse.js"),require("@lrnwebcomponents/a11y-collapse/lib/a11y-collapse-group.js"),require("@lrnwebcomponents/editable-table/lib/editable-table-display.js"),require("@lrnwebcomponents/a11y-tabs/a11y-tabs.js"),require("@lrnwebcomponents/a11y-tabs/lib/a11y-tab.js"),require("@lrnwebcomponents/grid-plate/grid-plate.js"),require("@lrnwebcomponents/iframe-loader/lib/loading-indicator.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icons.js"),require("@lrnwebcomponents/simple-tooltip/simple-tooltip.js"),require("@github/time-elements/dist/time-elements.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/simple-popover/simple-popover.js","@lrnwebcomponents/md-block/md-block.js","@lrnwebcomponents/video-player/video-player.js","@lrnwebcomponents/csv-render/csv-render.js","lit-element/lit-element.js","@lrnwebcomponents/simple-colors/simple-colors.js","@lrnwebcomponents/i18n-manager/lib/I18NMixin.js","@lrnwebcomponents/utils/utils.js","@lrnwebcomponents/utils/lib/gSheetsInterface.js","@lrnwebcomponents/simple-fields/lib/simple-fields-field.js","@lrnwebcomponents/simple-fields/lib/simple-fields-tag-list.js","@lrnwebcomponents/a11y-collapse/a11y-collapse.js","@lrnwebcomponents/a11y-collapse/lib/a11y-collapse-group.js","@lrnwebcomponents/editable-table/lib/editable-table-display.js","@lrnwebcomponents/a11y-tabs/a11y-tabs.js","@lrnwebcomponents/a11y-tabs/lib/a11y-tab.js","@lrnwebcomponents/grid-plate/grid-plate.js","@lrnwebcomponents/iframe-loader/lib/loading-indicator.js","@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js","@lrnwebcomponents/simple-icon/lib/simple-icons.js","@lrnwebcomponents/simple-tooltip/simple-tooltip.js","@github/time-elements/dist/time-elements.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GradeBook={},null,null,null,null,e.litElement_js,e.simpleColors_js,e.I18NMixin_js,e.utils_js,e.gSheetsInterface_js)}(this,(function(e,t,n,i,a,s,r,o,l,d){"use strict";function c(e,t,n,i,a,s,r){try{var o=e[s](r),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var s=e.apply(t,n);function r(e){c(s,i,a,r,o,"next",e)}function o(e){c(s,i,a,r,o,"throw",e)}r(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?S(e):t}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y(e);if(t){var a=y(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return k(this,n)}}function j(e,t,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function A(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function R(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var O,D,I,_,N,C,P,L,E,G,T,z,U,B,M,F=function(e){v(n,e);var t=x(n);function n(){var e;return p(this,n),(e=t.call(this)).student={},e.t={profileImageFor:"Profile image for",userID:"User ID",preferredName:"Preferred name",emailAddress:"Email this student",notes:"Notes",interests:"Interests"},e.registerLocalization({context:S(e),namespace:"grade-book"}),e}return g(n,[{key:"render",value:function(){return s.html(O||(O=A(['\n      <grid-plate layout="1-2" disable-responsive>\n        <div slot="col-1" style="text-align:center;">\n          ','\n        </div>\n        <div slot="col-2">\n          <h2>',"</h2>\n          <ul>\n            ","\n            ","\n            ","\n            ","\n            ","\n          </ul>\n        </div>\n      </grid-plate>\n    "])),this.student.photo?s.html(D||(D=A(['\n                <img\n                  src="','"\n                  alt="'," ",'"\n                />\n              '])),this.student.photo,this.t.photoOf,this.student.prefName):s.html(I||(I=A(['\n                <simple-icon-lite icon="account-circle"></simple-icon-lite>\n              ']))),this.student.name,this.student.userId?s.html(_||(_=A(["<li>",": ","</li>"])),this.t.userID,this.student.userId):"",this.student.prefName?s.html(N||(N=A(["<li>",": ","</li>"])),this.t.preferredName,this.student.prefName):"",this.student.email?s.html(C||(C=A(['<li>\n                  <a href="mailto:','"\n                    >',"</a\n                  >\n                </li>"])),this.student.email,this.t.emailAddress):"",this.student.notes?s.html(P||(P=A(["<li>",": ","</li>"])),this.t.notes,this.student.notes):"",this.student.interests?s.html(L||(L=A(["<li>\n                  ",": ","\n                </li>"])),this.t.interests,this.student.interests.join(",")):"")}}],[{key:"properties",get:function(){return{student:{type:Object}}}},{key:"styles",get:function(){return s.css(E||(E=A(["\n      :host {\n        display: block;\n      }\n      img {\n        max-width: 150px;\n        height: 150px;\n        border-radius: 50%;\n      }\n      grid-plate {\n        --grid-plate-col-transition: none;\n        --grid-plate-item-margin: 0px;\n        --grid-plate-item-padding: 4px;\n      }\n      simple-icon-lite {\n        --simple-icon-height: 150px;\n        --simple-icon-width: 150px;\n      }\n    "])))}},{key:"tag",get:function(){return"grade-book-student-block"}}]),n}(o.I18NMixin(s.LitElement));customElements.define(F.tag,F);var V,W,H,Y,J,Q,$,K,X,Z,ee,te,ne,ie,ae,se,re,oe,le,de,ce,ue,pe,he,ge,me,be,fe,ve,ye,we,Se,ke,xe,je,Ae,Re=function(e){v(n,e);var t=x(n);function n(){var e;return p(this,n),(e=t.call(this)).pointsSystem="pts",e.score=null,e.total=null,e.gradeScale=[],e._letterIndex=null,e.letter="",e.showScale=!1,e.value="",e.mini=!1,e.label="",e}return g(n,[{key:"render",value:function(){return s.html(G||(G=A(['\n      <div class="wrap">\n        <div class="letter">',"</div>\n        ","\n        ","\n      </div>\n      ","\n    "])),this.letter,this.showScale&&null!==this._letterIndex?s.html(T||(T=A(['<div class="score">\n              (',"/"," ",")\n            </div>"])),this.score,this.total,this.pointsSystem):"",this.showScale&&null!==this._letterIndex?s.html(z||(z=A(['<div class="range">\n              ',"% -\n              ","%\n            </div>"])),this.gradeScale[this._letterIndex].lowRange,this.gradeScale[this._letterIndex].highRange):"",this.mini?s.html(U||(U=A(['<simple-tooltip position="top"\n            >',"<br />","</simple-tooltip\n          >"])),this.label,null!=this.score?s.html(B||(B=A(["(","/"," ",")"])),this.score,this.total,this.pointsSystem):""):"")}},{key:"updated",value:function(e){var t=this;e.forEach((function(e,n){"mini"===n&&t[n]&&t.label,["total","score","gradeScale"].includes(n)&&t.gradeScale.length>0&&(t.letter=t.calculateLetterGrade())}))}},{key:"calculateLetterGrade",value:function(){if(null===this.score)return"/";var e=this.score/this.total*100;if(this.gradeScale[0]&&e>=this.gradeScale[0].highRange)return this._letterIndex=0,this.gradeScale[0].letter;for(var t in this.gradeScale){var n=this.gradeScale[t];if(e<=n.highRange&&e>=n.lowRange)return this._letterIndex=t,this.gradeScale[t].letter}return this._letterIndex=this.gradeScale.length-1,this.gradeScale[this.gradeScale.length-1].letter}}],[{key:"styles",get:function(){return[s.css(M||(M=A(['\n        :host {\n          display: block;\n        }\n        :host([letter="/"]) {\n          --letter-grade-default-letter-background-color: #cccccc;\n        }\n        :host([letter="F"]) {\n          --letter-grade-default-letter-background-color: #ff4444;\n        }\n        :host([letter="D"]) {\n          --letter-grade-default-letter-background-color: #ff7744;\n        }\n        :host([letter="C"]),\n        :host([letter="C+"]) {\n          --letter-grade-default-letter-background-color: #ffff00;\n        }\n        :host([letter="B"]),\n        :host([letter="B-"]) {\n          --letter-grade-default-letter-background-color: #ffff66;\n        }\n        :host([letter="B+"]),\n        :host([letter="A-"]) {\n          --letter-grade-default-letter-background-color: #aaffaa;\n        }\n        :host([letter="A"]) {\n          --letter-grade-default-letter-background-color: #55ff55;\n        }\n        :host([show-scale]) .wrap {\n          height: var(--letter-grade-wrap-height, 64px);\n          width: var(--letter-grade-wrap-width, 64px);\n        }\n        :host([mini]) .wrap {\n          height: var(--letter-grade-wrap-height, 16px);\n          width: var(--letter-grade-wrap-width, 16px);\n          border: 1px solid black;\n          border-radius: 0px;\n          padding: 8px;\n        }\n        :host([mini]) .letter {\n          font-size: var(--letter-grade-letter-font-size, 12px);\n          line-height: var(\n            --letter-grade-letter-line-height,\n            var(--letter-grade-letter-font-size, 12px)\n          );\n        }\n        .wrap {\n          height: var(--letter-grade-wrap-height, 40px);\n          width: var(--letter-grade-wrap-width, 40px);\n          padding: var(--letter-grade-wrap-padding, 16px);\n          border: var(--letter-grade-wrap-border, 4px solid black);\n          border-radius: 50%;\n          box-shadow: rgb(0 0 0 / 20%) 0px 5px 5px 0px;\n          text-align: center;\n          justify-content: center;\n          vertical-align: middle;\n          background-color: var(\n            --letter-grade-wrap-background-color,\n            var(--letter-grade-default-letter-background-color, transparent)\n          );\n        }\n        .letter {\n          font-weight: var(--letter-grade-letter-font-weight, bold);\n          font-size: var(--letter-grade-letter-font-size, 40px);\n          line-height: var(\n            --letter-grade-letter-line-height,\n            var(--letter-grade-letter-font-size, 40px)\n          );\n          letter-spacing: -2px;\n        }\n        .score,\n        .range {\n          font-weight: var(--letter-grade-range-font-weight, normal);\n          font-size: var(--letter-grade-range-font-size, 12px);\n        }\n        simple-tooltip {\n          --simple-tooltip-background: #000000;\n          --simple-tooltip-opacity: 1;\n          --simple-tooltip-text-color: #ffffff;\n          --simple-tooltip-delay-in: 0;\n          --simple-tooltip-duration-in: 200ms;\n          --simple-tooltip-duration-out: 0;\n          --simple-tooltip-border-radius: 0;\n          --simple-tooltip-font-size: 14px;\n          --simple-tooltip-width: 145px;\n        }\n      '])))]}},{key:"properties",get:function(){return{score:{type:Number},total:{type:Number},value:{type:Number},pointsSystem:{type:String,attribute:"points-system"},gradeScale:{type:Array,attribute:"grade-scale"},letter:{type:String,reflect:!0},showScale:{type:Boolean,reflect:!0,attribute:"show-scale"},mini:{type:Boolean,reflect:!0},label:{type:String}}}},{key:"tag",get:function(){return"letter-grade"}}]),n}(s.LitElement);customElements.define(Re.tag,Re);var qe=function(e){v(n,e);var t=x(n);function n(){var e;return p(this,n),(e=t.call(this)).gSheet=new d.gSheetInterface(S(e),{tags:0,roster:118800528,assignments:540222065,rubrics:1744429439,submissions:2104732668,gradeScale:980501320,grades:2130903440,gradesDetails:644559151,settings:1413275461}),e.assessmentView=e.resetAssessmentView(),e.totalScore=0,e.activeStudent=0,e.activeAssignment=0,e.activeSubmission=null,e.activeStudentSubmissions=[],e.scoreLock=!0,e.activeRubric=[],e.activeGrading={},e.database={tags:{categories:[],data:[]},submissions:[],rubrics:[],assignments:[],roster:[],grades:{},gradesDetails:{},gradeScale:[],settings:{}},e.hideGradeScale=!0,e.disabled=!1,e.loading=!0,e.t={csvURL:"CSV URL",debugData:"Debug data",points:"Points",criteria:"Criteria",description:"Description",assessmentWeight:"Assessment Weight",overallFeedback:"Overall feedback",letterGrade:"Letter grade",highRange:"High range",lowRange:"Low range",noSubmission:"No submission found",studentSubmission:"Student submission",openInNewWindow:"Open in new window",gradingScale:"Grading Scale"},e.registerLocalization({context:S(e),basePath:"undefined"==typeof document?new(require("url").URL)("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("grade-book.umd.js",document.baseURI).href,locales:["es","fr","de"]}),e.addEventListener("simple-fields-tag-list-changed",e.qualitativeFeedbackUpdate.bind(S(e))),e.addEventListener("value-changed",e.rubricCriteriaPointsChange),e.addEventListener("drop",e._handleDragDrop.bind(S(e))),e}return g(n,[{key:"resetAssessmentView",value:function(){return{qualitative:[],written:[]}}},{key:"getStudentSubmissions",value:function(e){var t=[];for(var n in this.database.submissions){var i=this.database.submissions[n];if(i.student===this.database.roster[e].student){for(var a in i)if("student"!==a){var s=this.getAssignmentByShortName(a);s&&t.push({studentScore:""==this.database.grades[e][a]?null:this.database.grades[e][a],assignmentPoints:s.points,assignmentName:s.name,assignmentIndex:s.index})}return t}}return t}},{key:"getAssignmentByShortName",value:function(e){var t,n=this.database.assignments.filter((function(n,i){return n.shortName===e&&(t=i,!0)}));return 1===n.length?(n[0].index=t,n[0]):null}},{key:"getCurrentScore",value:function(e,t){return this.database.grades[e][this.database.assignments[t].shortName]?this.database.grades[e][this.database.assignments[t].shortName]:0}},{key:"getActiveSubmission",value:function(){for(var e in this.database.submissions){var t=this.database.submissions[e];if(t.student===this.database.roster[this.activeStudent].student&&t[this.database.assignments[this.activeAssignment].shortName])return t[this.database.assignments[this.activeAssignment].shortName]}return null}},{key:"getActiveRubric",value:function(){var e=this;return this.database.rubrics.filter((function(t){return t.shortName==e.database.assignments[e.activeAssignment].rubric}))}},{key:"updated",value:function(e){var t=this;j(y(n.prototype),"updated",this)&&j(y(n.prototype),"updated",this).call(this,e),e.forEach((function(e,n){"debug"==n&&t[n],["activeAssignment","activeStudent","database","loading"].includes(n)&&(t.activeSubmission=t.getActiveSubmission(),t.assessmentView=t.resetAssessmentView(),t.activeRubric=t.getActiveRubric(),t.activeStudentSubmissions=[],t.activeStudentSubmissions=R(t.getStudentSubmissions(t.activeStudent)),t.shadowRoot&&t.shadowRoot.querySelector(".mini-map div[data-active-assignment-student-pixel]")&&setTimeout((function(){t.shadowRoot.querySelector(".mini-map").scrollTop=t.shadowRoot.querySelector(".mini-map div[data-active-assignment-student-pixel]").offsetTop-120-t.shadowRoot.querySelector(".mini-map").offsetTop}),100)),"sheet"==n&&t[n]&&(clearTimeout(t.__debouce),t.__debouce=setTimeout(u(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loading=!0,t.gSheet.sheet=t[n],e.t0=regeneratorRuntime.keys(t.gSheet.sheetGids);case 3:if((e.t1=e.t0()).done){e.next=11;break}return i=e.t1.value,e.next=7,t.gSheet.loadSheetData(i);case 7:t.database[i]=e.sent,t.requestUpdate(),e.next=3;break;case 11:t.loading=!1,setTimeout((function(){if(t.database.gradeScale.length>0){var e=t.shadowRoot.querySelectorAll("letter-grade");for(var n in Array.from(e))e[n].gradeScale=t.database.gradeScale}}),0);case 13:case"end":return e.stop()}}),e)}))),0))}))}},{key:"processassignmentsData",value:function(e,t,n){for(var i in n){var a=new Date("".concat(n[i].dueDate," ").concat(n[i].dueTime));n[i]._ISODueDate=a.toISOString()}return n}},{key:"processtagsData",value:function(e,t,n){var i=new Set([]),a=[];for(var s in n)n[s].category=n[s].category?n[s].category.split(","):[],n[s].associatedMaterial=n[s].associatedMaterial?n[s].associatedMaterial.split(","):[],n[s].category.forEach((function(e){i.add(e)})),a=R(Array.from(i));return{categories:a,data:n}}},{key:"processrubricsData",value:function(e,t,n){for(var i in n)n[i].qualitative=n[i].qualitative?n[i].qualitative.split(","):[];return n}},{key:"processrosterData",value:function(e,t,n){for(var i in n)n[i].interests=n[i].interests?n[i].interests.split(","):[];return n}},{key:"processsettingsData",value:function(e,t,n){var i={};for(var a in n)i[n[a].key]=n[a].value;return i}},{key:"changeStudent",value:function(e){"prev"==e.target.value&&0!==this.activeStudent?this.activeStudent--:"next"==e.target.value&&this.database.roster.length-1!==this.activeStudent&&this.activeStudent++,this.requestUpdate()}},{key:"changeAssignment",value:function(e){"prev"==e.target.value&&0!==this.activeAssignment?this.activeAssignment--:"next"==e.target.value&&this.database.assignments.length-1!==this.activeAssignment&&this.activeAssignment++,this.requestUpdate()}},{key:"renderSubmission",value:function(e){var t=s.html(V||(V=A(["<h3>","</h3>"])),this.t.studentSubmission);return l.validURL(e)?(t=s.html(W||(W=A(["",'<a\n          href="','"\n          target="_blank"\n          rel="noopener noreferrer"\n          ><simple-icon-button-lite\n            label="','"\n            icon="open-in-new"\n          ></simple-icon-button-lite\n        ></a>'])),t,e,this.t.openInNewWindow),e!=l.cleanVideoSource(e)?s.html(H||(H=A(["",'<video-player\n            class="active-submission"\n            source="','"\n            width="60%"\n          ></video-player>'])),t,e):s.html(Y||(Y=A(["",'\n          <div class="active-submission">\n            <iframe\n              src="','"\n              loading="lazy"\n              width="100%"\n              height="100%"\n            ></iframe>\n          </div>'])),t,e)):s.html(J||(J=A(["",'\n        <div class="active-submission">\n          <md-block .markdown="','"></md-block>\n        </div>'])),t,e)}},{key:"studentLetterGradeHistoryClick",value:function(e){this.activeAssignment=parseInt(e.target.value),this.requestUpdate()}},{key:"toggleGradeScale",value:function(e){this.hideGradeScale=!this.hideGradeScale}},{key:"render",value:function(){var e=this;return s.html(Q||(Q=A(['\n      <grid-plate layout="1-1-1">\n        <div slot="col-1">\n          <simple-icon-button-lite\n            @click="','"\n            value="prev"\n            ?disabled="','"\n            icon="arrow-back"\n          >\n            Previous student\n          </simple-icon-button-lite>\n          <simple-icon-button-lite\n            @click="','"\n            value="next"\n            icon="arrow-forward"\n            ?disabled="','"\n          >\n            Next student\n          </simple-icon-button-lite>\n        </div>\n        <div slot="col-2">\n          <simple-icon-button-lite\n            @click="','"\n            value="prev"\n            icon="arrow-back"\n            ?disabled="','"\n          >\n            Previous assignment\n          </simple-icon-button-lite>\n          <simple-icon-button-lite\n            @click="','"\n            value="next"\n            ?disabled="','"\n            icon="arrow-forward"\n          >\n            Next Assignment\n          </simple-icon-button-lite>\n          <simple-icon-button-lite\n            icon="list"\n            @click="','"\n            id="gradescalebtn"\n          >\n            ','\n          </simple-icon-button-lite>\n          <simple-popover\n            ?hidden="','"\n            for="gradescalebtn"\n            auto\n          >\n            <editable-table-display\n              accent-color="','"\n              bordered\n              column-header\n              condensed\n              disable-responsive\n              scroll\n              striped\n            >\n              <table>\n                <tbody>\n                  <tr>\n                    <td>',"</td>\n                    <td>","</td>\n                    <td>","</td>\n                  </tr>\n                  ",'\n                </tbody>\n              </table>\n            </editable-table-display>\n          </simple-popover>\n        </div>\n        <loading-indicator\n          ?loading="','"\n          slot="col-3"\n        ></loading-indicator>\n      </grid-plate>\n      <a11y-tabs full-width>\n        <a11y-tab icon="social:person" label="Active student">\n          <grid-plate layout="3-1">\n            <div slot="col-1">\n              ','\n            </div>\n            <div slot="col-2">\n              ','\n            </div>\n          </grid-plate>\n        </a11y-tab>\n        <a11y-tab icon="assignment-ind" label="Active Assessment">\n          ','\n        </a11y-tab>\n      </a11y-tabs>\n      <div>\n        <a11y-tabs\n          full-width\n          @a11y-tabs-active-changed="','"\n        >\n          <a11y-tab\n            icon="image:style"\n            label="Assessment view"\n            id="assessmentview"\n          >\n            ','\n          </a11y-tab>\n          <a11y-tab icon="assignment" label="Student report">\n            <div>\n              ',"\n            </div>\n          </a11y-tab>\n        </a11y-tabs>\n      </div>\n    "])),this.changeStudent,0===this.activeStudent,this.changeStudent,this.database.roster.length-1===this.activeStudent,this.changeAssignment,0===this.activeAssignment,this.changeAssignment,this.database.assignments.length-1===this.activeAssignment,this.toggleGradeScale,this.t.gradingScale,this.hideGradeScale,this.accentColor,this.t.letterGrade,this.t.highRange,this.t.lowRange,this.database.gradeScale.map((function(e){return s.html($||($=A(["\n                      <tr>\n                        <td>","</td>\n                        <td>","</td>\n                        <td>","</td>\n                      </tr>\n                    "])),e.letter,e.highRange,e.lowRange)})),this.loading,this.database.roster[this.activeStudent]&&this.database.grades[this.activeStudent]?s.html(K||(K=A(['\n                    <grade-book-student-block\n                      .student="','"\n                    ></grade-book-student-block>\n                    <div class="active-student-grade-history">\n                      ',"\n                    </div>\n                  "])),this.database.roster[this.activeStudent],this.activeStudentSubmissions.map((function(t){return s.html(X||(X=A(['\n                          <button\n                            .value="','"\n                            @click="','"\n                            class="','"\n                          >\n                            <letter-grade\n                              mini\n                              label="','"\n                              .total="','"\n                              .score="','"\n                              .value="','"\n                            >\n                            </letter-grade>\n                          </button>\n                        '])),t.assignmentIndex,e.studentLetterGradeHistoryClick,e.activeAssignment===t.assignmentIndex?"activeAssignment":"",t.assignmentName,t.assignmentPoints,t.studentScore,t.assignmentIndex)}))):s.html(Z||(Z=A(["<loading-indicator></loading-indicator>"]))),this.database.roster.length&&this.database.assignments.length?s.html(ee||(ee=A(['\n                    <h4>Active submission map</h4>\n                    <div class="mini-map">\n                      ',"\n                    </div>\n                  "])),this.database.roster.map((function(t,n){return s.html(te||(te=A([" <div data-pixel-row>\n                          ","\n                        </div>"])),e.database.assignments.map((function(t,i){return s.html(ne||(ne=A(['\n                              <div\n                                data-pixel-col\n                                ?data-active-assignment-student-pixel="','"\n                              ></div>\n                            '])),e.activeStudent===n&&e.activeAssignment===i)})))}))):s.html(ie||(ie=A(["<loading-indicator></loading-indicator>"]))),this.database.assignments.length&&this.database.assignments[this.activeAssignment]?s.html(ae||(ae=A(["\n                <h3>\n                  ",'\n                </h3>\n                <ul>\n                  <li>\n                    Due date:\n                    <local-time\n                      datetime="','"\n                      month="short"\n                      day="numeric"\n                      year="numeric"\n                      hour="numeric"\n                      minute="numeric"\n                      time-zone-name="short"\n                    >\n                    </local-time>\n                  </li>\n                  <li>\n                    Date submitted:\n                    ',"\n                    minutes ago\n                  </li>\n                </ul>\n                <div>\n                  ","\n                </div>\n              "])),this.database.assignments[this.activeAssignment].name,this.database.assignments[this.activeAssignment]._ISODueDate,Math.floor(this.database.assignments[this.activeAssignment]._ISODueDate-new Date("2021-03-01T10:20:08"))/6e4,this.activeSubmission?this.renderSubmission(this.activeSubmission):s.html(se||(se=A(["",""])),this.t.noSubmission)):s.html(re||(re=A(["<loading-indicator></loading-indicator>"]))),this.updateStudentReport,this.activeRubric[0]?s.html(oe||(oe=A(['\n                  <grid-plate layout="3-1">\n                  <div slot="col-1">\n                    <h3>',"</h3>\n                    ",'\n                    <div class="student-feedback-wrap">\n                      <div class="student-feedback-text">\n                        <h3 class="heading">Overall feedback</h3>\n                        <simple-fields-field\n                          type="textarea"\n                          data-criteria="overall"\n                          data-rubric-written\n                        ></simple-fields-field>\n                      </div>\n                      <div class="student-feedback-score">\n                        <simple-icon-button-lite\n                          icon="','"\n                          @click="','"\n                        ></simple-icon-button-lite>\n                        <simple-fields-field\n                          ?disabled="','"\n                          type="number"\n                          min="0"\n                          id="totalpts"\n                          maxlength="10"\n                          @value-changed="','"\n                        ></simple-fields-field>\n                        /\n                        ','\n                        pts\n                        <letter-grade\n                          style="margin:-8px 0 0 16px;"\n                          total="','"\n                          score="','"\n                        ></letter-grade>\n                      </div>\n                    </div>\n                  </div>\n                  <div slot="col-2" class="tag-group">\n          ',"\n                  </div>\n                  </div>\n                  </grid-plate>\n                "])),this.activeRubric[0].name,this.activeRubric.map((function(t){return s.html(le||(le=A(["\n                        <h4>","</h4>\n                        <p>",'</p>\n                        <editable-table-display\n                          accent-color="','"\n                          bordered\n                          column-header\n                          condensed\n                          disable-responsive\n                          scroll\n                          striped\n                        >\n                          <table>\n                            <tbody>\n                              <tr>\n                                ',"\n                                <td>"," %</td>\n                              </tr>\n                              <tr>\n                                ",'\n                                <td>\n                                  <simple-fields-field\n                                    type="number"\n                                    part="simple-fields-field"\n                                    min="0"\n                                    value="','"\n                                    max="','"\n                                    maxlength="10"\n                                    data-rubric-score\n                                    data-criteria="','"\n                                  ></simple-fields-field>\n                                </td>\n                              </tr>\n                            </tbody>\n                          </table>\n                        </editable-table-display>\n                        <h4>Additional ',' feedback</h4>\n                        <simple-fields-field\n                          type="textarea"\n                          data-rubric-written\n                          data-criteria="','"\n                        ></simple-fields-field>\n                      '])),t.criteria,t.description,e.accentColor,t.qualitative.map((function(e){return s.html(de||(de=A([" <td>","</td> "])),e)})),t.percentage,t.qualitative.map((function(e){return s.html(ce||(ce=A(['\n                                    <td>\n                                      <simple-fields-tag-list\n                                        style="background-color:transparent;"\n                                        data-criteria="','"\n                                        label="','"\n                                      ></simple-fields-tag-list>\n                                    </td>\n                                  '])),t.criteria,e)})),"max"===e.database.settings.defaultScore?Math.round(t.percentage/100*e.database.assignments[e.activeAssignment].points):e.database.settings.defaultScore,Math.round(t.percentage/100*e.database.assignments[e.activeAssignment].points),t.criteria,t.criteria,t.criteria)})),this.scoreLock?"lock":"lock-open",this.toggleLock,this.scoreLock,this.totalScoreChangedEvent,this.database.assignments[this.activeAssignment].points,this.database.assignments[this.activeAssignment].points,this.totalScore,this.database.tags.categories.length>0?s.html(ue||(ue=A(["\n                  <h4>Qualitative Rubric Tags</h4>\n                  <a11y-collapse-group heading-button>\n                    ","\n                  </a11y-collapse-group>\n                "])),this.database.tags.categories.map((function(t,n){return s.html(pe||(pe=A(['\n                        <a11y-collapse>\n                          <div slot="heading">\n                            <simple-colors accent-color="','"\n                              ><span></span></simple-colors\n                            >','\n                          </div>\n                          <div slot="content">\n                            ',"\n                          </div>\n                        </a11y-collapse>\n                      "])),e.pickColor(n),t,e.database.tags.data.filter((function(e){return e.category.includes(t)})).map((function(t){return s.html(he||(he=A(['<simple-tag\n                                    draggable="true"\n                                    tabindex="0"\n                                    @keypress="','"\n                                    @dragstart="','"\n                                    accent-color="','"\n                                    value="','"\n                                    .data="','"\n                                  ></simple-tag>'])),e.keyDown,e.setDragTransfer,e.pickColor(n),t.term,t)})))}))):s.html(ge||(ge=A(["<loading-indicator></loading-indicator>"])))):s.html(me||(me=A(["<loading-indicator></loading-indicator>"]))),this.loading?s.html(je||(je=A(["<loading-indicator></loading-indicator>"]))):s.html(be||(be=A(['\n                    <h2>Student feedback report</h2>\n                    <div class="student-report-wrap">\n                      <a11y-collapse-group\n                        heading-button\n                        expanded\n                        style="width:80%;"\n                      >\n                        ','\n                        <a11y-collapse class="student-feedback-text">\n                          <div slot="heading" class="heading">\n                            ','\n                          </div>\n                          <div slot="content">\n                            <p>','</p>\n                            <h3>Your total Score</h3>\n                            <div class="score-display">\n                              '," /\n                              ",'\n                              pts\n                            </div>\n                          </div>\n                        </a11y-collapse>\n                      </a11y-collapse-group>\n                      <letter-grade\n                        class="student-report-score"\n                        show-scale\n                        total="','"\n                        score="','"\n                      ></letter-grade>\n                    </div>\n                  '])),this.database.rubrics.filter((function(t){return t.shortName==e.database.assignments[e.activeAssignment].rubric})).map((function(t){return s.html(fe||(fe=A(['\n                              <a11y-collapse class="student-feedback-text">\n                                <div slot="heading" class="heading">\n                                  ','\n                                </div>\n                                <div slot="content">\n                                  <div class="student-feedback-score-heading">\n                                    <div>\n                                      ',"\n                                      /\n                                      ","\n                                    </div>\n                                    <h3>Criteria details</h3>\n                                  </div>\n                                  <p>","</p>\n                                  <h3>Your feedback</h3>\n                                  <ul>\n                                    ","\n                                  </ul>\n                                  <h3>Additional Criteria feedback</h3>\n                                  <p>\n                                    ","\n                                  </p>\n                                </div>\n                              </a11y-collapse>\n                            "])),t.criteria,e.getCriteriaScore(t.criteria),Math.round(t.percentage/100*e.database.assignments[e.activeAssignment].points),t.description,t.qualitative.map((function(n){return s.html(ve||(ve=A(["\n                                        <h4>","</h4>\n                                        <ul>\n                                          ","\n                                        </ul>\n                                      "])),n,e.activeGrading[t.criteria]?s.html(ye||(ye=A(["",""])),e.activeGrading[t.criteria][n].map((function(e){return s.html(we||(we=A([" <li>\n                                                  <span>","</span\n                                                  >","\n                                                  ","\n                                                </li>"])),e.term,e.description?s.html(Se||(Se=A([" - ",""])),e.description):"",e.associatedMaterial?s.html(ke||(ke=A(["\n                                                        <ul>\n                                                          ","\n                                                        </ul>\n                                                      "])),e.associatedMaterial.map((function(e){return s.html(xe||(xe=A(['\n                                                              <li>\n                                                                <a\n                                                                  href="','"\n                                                                  target="_blank"\n                                                                  rel="noopener noreferrer"\n                                                                  >',"</a\n                                                                >\n                                                              </li>\n                                                            "])),e,e)}))):"")}))):"")})),e.getCriteriaFeedback(t.criteria))})),this.t.overallFeedback,this.getCriteriaFeedback("overall"),this.totalScore,this.database.assignments[this.activeAssignment].points,this.database.assignments[this.activeAssignment].points,this.totalScore))}},{key:"rubricCriteriaPointsChange",value:function(e){var t=this;null!=e.detail.getAttribute("data-rubric-score")&&(clearTimeout(this.__debouce),this.__debouce=setTimeout((function(){t.loading||(t.updateTotalScore(),t.totalScore=t.getCurrentScore(t.activeStudent,t.activeAssignment),t.shadowRoot.querySelector("#totalpts").value=t.totalScore),t.scoreLock=!0}),10))}},{key:"updateTotalScore",value:function(){var e=0,t=this.shadowRoot.querySelectorAll("#assessmentview editable-table-display");for(var n in Array.from(t))t[n].shadowRoot.querySelector("[data-rubric-score]").value&&(e+=parseInt(t[n].shadowRoot.querySelector("simple-fields-field").value));this.totalScore=e,this.requestUpdate()}},{key:"totalScoreChangedEvent",value:function(e){this.totalScore=e.detail.value,this.database.grades[this.activeStudent][this.database.assignments[this.activeAssignment].shortName]=this.totalScore,this.activeStudentSubmissions=[],this.activeStudentSubmissions=R(this.getStudentSubmissions(this.activeStudent)),this.requestUpdate()}},{key:"toggleLock",value:function(e){this.scoreLock=!this.scoreLock}},{key:"updateStudentReport",value:function(){this.requestUpdate()}},{key:"getCriteriaScore",value:function(e){var t=this.shadowRoot.querySelectorAll("#assessmentview editable-table-display");for(var n in Array.from(t))if(t[n].shadowRoot.querySelector('[data-rubric-score][data-criteria="'.concat(e,'"]')))return t[n].shadowRoot.querySelector('[data-rubric-score][data-criteria="'.concat(e,'"]')).value;return 0}},{key:"getCriteriaFeedback",value:function(e){return this.shadowRoot.querySelector('#assessmentview [data-rubric-written][data-criteria="'.concat(e,'"]'))?this.shadowRoot.querySelector('#assessmentview [data-rubric-written][data-criteria="'.concat(e,'"]')).value:""}},{key:"qualitativeFeedbackUpdate",value:function(e){this.activeGrading[e.detail.getAttribute("data-criteria")]||(this.activeGrading[e.detail.getAttribute("data-criteria")]={}),this.activeGrading[e.detail.getAttribute("data-criteria")][e.detail.label]=e.detail.tagList,this.requestUpdate()}},{key:"keyDown",value:function(e){e.key}},{key:"pickColor",value:function(e){for(var t=Object.keys(this.colors);e>t.length;)e-=t.length;return t[e]}},{key:"_handleDragDrop",value:function(e){window.dispatchEvent(new CustomEvent("simple-tag-drop",{detail:{value:"drop"}}))}},{key:"setDragTransfer",value:function(e){window.dispatchEvent(new CustomEvent("simple-tag-dragstart",{detail:{value:e.target}}));var t=e.target.data;t.color=e.target.accentColor,e.dataTransfer.setData("text",JSON.stringify(t))}}],[{key:"properties",get:function(){return f(f({},j(y(n),"properties",this)),{},{hideGradeScale:{type:Boolean},disabled:{type:Boolean,reflect:!0},loading:{type:Boolean,reflect:!0},activeStudent:{type:Number,attribute:"active-student"},activeAssignment:{type:Number,attribute:"active-assignment"},totalScore:{type:Number},scoreLock:{type:Boolean},debug:{type:Boolean},sheet:{type:String},activeSubmission:{type:String,attribute:!1},database:{type:Object,attribute:!1},activeRubric:{type:Object,attribute:!1},assessmentView:{type:Object,attribute:!1},activeGrading:{type:Object,attribute:!1},activeStudentSubmissions:{type:Array}})}},{key:"styles",get:function(){return[].concat(R(j(y(n),"styles",this)),[s.css(Ae||(Ae=A(['\n        :host {\n          display: block;\n        }\n        loading-indicator {\n          --loading-indicator-background-color: var(\n            --simple-colors-default-theme-accent-2,\n            grey\n          );\n          --loading-indicator-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n        }\n        grid-plate {\n          --hax-layout-container-transition: none;\n          --grid-plate-col-transition: none;\n          --grid-plate-item-margin: 8px;\n          --grid-plate-item-padding: 8px;\n        }\n        a11y-tabs {\n          --a11y-tabs-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n        }\n        a11y-collapse {\n          --a11y-collapse-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n        }\n        a11y-collapse:not([expanded]):hover {\n          background-color: var(--simple-colors-default-theme-accent-1, grey);\n        }\n        a11y-collapse div[slot="heading"] {\n          font-size: 16px;\n          font-weight: normal;\n          cursor: pointer;\n          line-height: 34px;\n          display: flex;\n        }\n        a11y-collapse[expanded] div[slot="heading"] {\n          font-weight: bold;\n        }\n        .active-student-grade-history {\n          display: flex;\n          width: 100%;\n        }\n        .active-student-grade-history letter-grade {\n          display: inline-flex;\n          margin: 2px;\n        }\n        .active-student-grade-history button {\n          opacity: 0.4;\n          background-color: transparent;\n          border: 0;\n          padding: 0;\n          margin: 0;\n        }\n        .active-student-grade-history button.activeAssignment {\n          opacity: 0.9;\n          background-color: yellow;\n        }\n        .active-student-grade-history button:focus,\n        .active-student-grade-history button:active,\n        .active-student-grade-history button:hover {\n          opacity: 1;\n          outline: 1px solid black;\n          outline-offset: 2px;\n        }\n        simple-fields-tag-list.drag-focus {\n          background-color: #dddddd;\n        }\n        simple-colors[accent-color] {\n          display: inline-flex;\n          width: 24px;\n          height: 24px;\n          margin: 4px 6px 0px 0px;\n        }\n        simple-colors[accent-color] span {\n          display: inline-flex;\n          width: 24px;\n          height: 24px;\n          background-color: var(\n            --simple-colors-default-theme-accent-3,\n            #eeeeee\n          );\n        }\n        simple-fields-field[type="textarea"] {\n          --simple-fields-font-size: 20px;\n        }\n        simple-fields-field[type="number"] {\n          --simple-fields-font-size: 40px;\n          line-height: 40px;\n        }\n\n        .student-feedback-score-heading {\n          display: flex;\n          font-size: 28px;\n          font-weight: bold;\n          line-height: 28px;\n          padding: 8px;\n        }\n        .student-feedback-score-heading h3 {\n          margin: 0 0 0 8px;\n          padding: 0px;\n        }\n\n        #totalpts {\n          width: 84px;\n          margin: 0px 12px;\n        }\n        .mini-map {\n          max-height: 150px;\n          max-width: 150px;\n          overflow: auto;\n        }\n        .mini-map div[data-pixel-row] {\n          height: 5px;\n        }\n        .mini-map div[data-pixel-col] {\n          background-color: yellow;\n          float: left;\n          width: 5px;\n          height: 5px;\n        }\n        .mini-map div[data-active-assignment-student-pixel] {\n          background-color: blue;\n        }\n        .student-feedback-wrap {\n          display: flex;\n        }\n        .student-feedback-wrap .student-feedback-text {\n          width: 80%;\n          margin: 0;\n        }\n        .student-feedback-wrap .student-feedback-text div.heading {\n          padding: 20px;\n        }\n        .student-feedback-wrap .student-feedback-score {\n          font-size: 40px;\n          line-height: 68px;\n          padding: 34px 16px;\n          display: flex;\n          width: 50%;\n        }\n        simple-tag {\n          margin: 2px;\n        }\n        simple-tag:focus,\n        simple-tag:hover {\n          --simple-fields-fieldset-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            #eeeeee\n          );\n        }\n        .active-submission {\n          max-height: 400px;\n          width: 60%;\n          overflow: auto;\n          margin: 0 auto;\n        }\n        .active-submission iframe {\n          height: 400px;\n          width: 60%;\n        }\n        .tag-group {\n          position: sticky;\n          top: 0;\n        }\n        .student-report-wrap {\n          display: flex;\n          justify-content: space-evenly;\n        }\n        .student-report-score {\n          margin-top: -20px;\n        }\n        editable-table-display::part(td),\n        editable-table-display::part(th) {\n          text-align: center;\n          vertical-align: top;\n          max-width: 250px;\n        }\n        editable-table-display::part(simple-fields-field) {\n          --simple-fields-font-size: 32px;\n          --simple-fields-text-align: center;\n          background-color: transparent;\n          max-width: 100px;\n          padding: 0 0 28px 0;\n          margin: 0;\n        }\n      '])))])}},{key:"tag",get:function(){return"grade-book"}}]),n}(o.I18NMixin(r.SimpleColors));customElements.define(qe.tag,qe),e.GradeBook=qe,Object.defineProperty(e,"__esModule",{value:!0})}));
