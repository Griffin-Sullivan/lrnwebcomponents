!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@lrnwebcomponents/code-editor/code-editor.js"),require("lit-element/lit-element.js"),require("shadow-selection-polyfill/shadow.js"),require("@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-button.js"),require("@lrnwebcomponents/rich-text-editor/lib/singletons/rich-text-editor-selection.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icons.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-button-lite.js"),require("@lrnwebcomponents/hax-iconset/lib/simple-hax-iconset.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-link.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-image.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-underline.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-symbol-picker.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-heading-picker.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-source-code.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-button.js"),require("@lrnwebcomponents/simple-toolbar/simple-toolbar.js"),require("@lrnwebcomponents/absolute-position-behavior/absolute-position-behavior.js"),require("@lrnwebcomponents/utils/utils.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/code-editor/code-editor.js","lit-element/lit-element.js","shadow-selection-polyfill/shadow.js","@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-button.js","@lrnwebcomponents/rich-text-editor/lib/singletons/rich-text-editor-selection.js","@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js","@lrnwebcomponents/simple-icon/lib/simple-icons.js","@lrnwebcomponents/simple-icon/lib/simple-icon-button-lite.js","@lrnwebcomponents/hax-iconset/lib/simple-hax-iconset.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-link.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-image.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-underline.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-symbol-picker.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-heading-picker.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-source-code.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-button.js","@lrnwebcomponents/simple-toolbar/simple-toolbar.js","@lrnwebcomponents/absolute-position-behavior/absolute-position-behavior.js","@lrnwebcomponents/utils/utils.js"],e):e((t=t||self).RichTextEditor={},null,t.litElement_js,t.shadow,t.simpleToolbarButton_js,null,null,null,null,null,null,null,null,null,null,null,t.richTextEditorButton_js,t.simpleToolbar_js,null,t.utils_js)}(this,function(t,e,n,o,i,r,a,s,c,l,d,u,h,b,p,g,m,f,y,v){"use strict";function k(t,e,n,o,i,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,i)}function w(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function a(t){k(r,o,i,a,s,"next",t)}function s(t){k(r,o,i,a,s,"throw",t)}a(void 0)})}}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function C(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),t}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach(function(e){E(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function j(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,o,i,r=T(t);if(e){var a=T(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o=this,!(i=n)||"object"!=typeof i&&"function"!=typeof i?R(o):i}}function N(t,e,n){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function A(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function H(t){return function(t){if(Array.isArray(t))return M(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function q(){var t=A(["\n    :host {\n      --simple-toolbar-border-color: var(--rich-text-editor-border-color, #ddd);\n      --simple-toolbar-border-width: var(--rich-text-editor-border-width, 1px);\n      --simple-toolbar-button-opacity: var(\n        --rich-text-editor-button-opacity,\n        1\n      );\n      --simple-toolbar-button-color: var(--rich-text-editor-button-color, #444);\n      --simple-toolbar-button-bg: var(--rich-text-editor-button-bg, #ffffff);\n      --simple-toolbar-button-border-color: var(\n        --rich-text-editor-button-border-color,\n        transparent\n      );\n      --simple-toolbar-button-toggled-opacity: var(\n        --rich-text-editor-button-toggled-opacity,\n        1\n      );\n      --simple-toolbar-button-toggled-color: var(\n        --rich-text-editor-button-toggled-color,\n        #222\n      );\n      --simple-toolbar-button-toggled-bg: var(\n        --rich-text-editor-button-toggled-bg,\n        #ddd\n      );\n      --simple-toolbar-button-toggled-border-color: var(\n        --rich-text-editor-button-toggled-border-color,\n        transparent\n      );\n      --simple-toolbar-button-hover-opacity: var(\n        --rich-text-editor-button-hover-opacity,\n        1\n      );\n      --simple-toolbar-button-hover-color: var(\n        --rich-text-editor-button-hover-color,\n        #000\n      );\n      --simple-toolbar-button-hover-bg: var(\n        --rich-text-editor-button-hover-bg,\n        #f0f0f0\n      );\n      --simple-toolbar-button-hover-border-color: var(\n        --rich-text-editor-button-hover-border-color,\n        unset\n      );\n      --simple-toolbar-button-disabled-opacity: var(\n        --rich-text-editor-button-disabled-opacity,\n        1\n      );\n      --simple-toolbar-button-disabled-color: var(\n        --rich-text-editor-button-disabled-color,\n        #666\n      );\n      --simple-toolbar-button-disabled-bg: var(\n        --rich-text-editor-button-disabled-bg,\n        transparent\n      );\n      --simple-toolbar-button-disabled-border-color: var(\n        --rich-text-editor-button-disabled-border-color,\n        transparent\n      );\n    }\n  "]);return q=function(){return t},t}function P(){var t=A(["\n    :host {\n      --simple-toolbar-border-color: var(--rich-text-editor-border-color, #ddd);\n      --simple-toolbar-border-width: var(--rich-text-editor-border-width, 1px);\n      --simple-toolbar-button-bg: var(--rich-text-editor-bg, #ffffff);\n      --simple-fields-focus-color: var(--rich-text-editor-focus-color, blue);\n      --simple-fields-invalid-color: var(--rich-text-editor-error-color, #800);\n    }\n  "]);return P=function(){return t},t}var U=[n.css(P())],D=[].concat(U,[n.css(q())]),I=function(t){return function(e){j(o,i.SimpleToolbarButtonBehaviors(t));var n=O(o);function o(){var t;return _(this,o),(t=n.call(this)).__selection=window.RichTextEditorSelection.requestAvailability(),t.tagsList="",t}return C(o,[{key:"render",value:function(){return N(T(o.prototype),"render",this).call(this)}}],[{key:"tag",get:function(){return"rich-text-editor-button"}},{key:"styles",get:function(){return[].concat(H(N(T(o),"styles",this)),H(D))}},{key:"properties",get:function(){return S(S({},N(T(o),"properties",this)),{},{command:{type:String,reflect:!0,attribute:"command"},commandVal:{attribute:"command-val",type:Object},range:{type:Object},tagsList:{type:String},target:{type:Object},toggledCommand:{attribute:"toggled-command",type:String,reflect:!0},toggledCommandVal:{attribute:"toggled-command-val",type:Object},selectedNode:{type:Object},selectionAncestors:{type:Array},__selection:{type:Object}})}}]),C(o,[{key:"firstUpdated",value:function(t){N(T(o.prototype),"firstUpdated",this)&&N(T(o.prototype),"firstUpdated",this).call(this,t)}},{key:"updated",value:function(t){var e=this;N(T(o.prototype),"updated",this).call(this,t),t.forEach(function(t,n){"controls"===n&&e._editorChanged(e.controls,t),"range"===n&&e._rangeChanged(e.range,t),["shortcutKeys","tagsList","tagClickCallback"].includes(n)&&e.updateButtonRegistry()})}},{key:"disconnectedCallback",value:function(){N(T(o.prototype),"disconnectedCallback",this).call(this)}},{key:"commandCallback",value:function(t,e,n){}},{key:"highlight",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.dispatchEvent(new CustomEvent("highlight",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"highlightNode",value:function(t){this.dispatchEvent(new CustomEvent("highlightnode",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"selectRange",value:function(t){this.dispatchEvent(new CustomEvent("selectrange",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"selectNode",value:function(t){this.dispatchEvent(new CustomEvent("selectnode",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"selectNodeContents",value:function(t){this.dispatchEvent(new CustomEvent("selectnodeccontents",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"tagClickCallback",value:function(t){}},{key:"wrapSelection",value:function(t){this.dispatchEvent(new CustomEvent("wrapselection",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"startNode",value:function(){var t=this.range?this.range.startContainer:void 0,e=this.range?this.range.startOffset:void 0;return t?t.children?t.children[e-1]:t.childNodes?t.childNodes[e-1]:void 0:void 0}},{key:"rangeElement",value:function(){return this.rangeIsElement()?this.startNode():this.rangeParent()}},{key:"rangeIsElement",value:function(){var t=this.range?this.range.startContainer:void 0,e=this.range?this.range.startOffset:void 0,n=this.range?this.range.endContainer:void 0,o=this.range?this.range.endOffset:void 0;return t===n&&o-e==1}},{key:"rangeParent",value:function(){var t=this.range?this.range.commonAncestorContainer:void 0;return t?1==t.nodeType?t:t.parentElement:void 0}},{key:"rangeQuery",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tagsList;t=t.toLowerCase().replace(/\s*/g,"");var e=this.rangeElement(),n=e&&e.tagName?e.tagName.toLowerCase():void 0,o=t.split(",");return e?n&&o.includes(n)?e:e.closest(t):void 0}},{key:"sendCommand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.operationCommand,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.operationCommandVal,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.range;this.dispatchEvent(new CustomEvent("command",{bubbles:!0,cancelable:!0,composed:!0,detail:{command:t,commandVal:e,range:n,button:this}}))}},{key:"setRange",value:function(){var t=this.rangeQuery();t&&this.selectNode(t)}},{key:"_handleClick",value:function(t){t.preventDefault(),this.sendCommand()}},{key:"_editorChanged",value:function(t,e){}},{key:"_getSelection",value:function(){return"formatBlock"===this.command?this.rangeQuery():this._getSelectedHtml()}},{key:"_getSelectedHtml",value:function(){if(this.range){var t,e=document.createElement("div"),n=this.range.cloneContents();return e.appendChild(n),t=e.innerHTML,e.remove(),t?t.trim():void 0}}},{key:"_getSelectedTag",value:function(){var t=this.rangeQuery();return!(!t||!t.tagName)&&t.tagName.toLowerCase()}},{key:"_getSelectionType",value:function(){return"formatBlock"===this.command?this._getSelectedTag():this._getSelectedHtml()}},{key:"_rangeChanged",value:function(t,e){}},{key:"isToggled",get:function(){var t=!(!this.range||!this.command)&&document.queryCommandState(this.command),e="underline"===this.command?!!this.rangeQuery("u"):t;return!(!this.toggles||!e)}},{key:"operationCommand",get:function(){return this.isToggled&&this.toggledCommand?this.toggledCommand:this.command}},{key:"operationCommandVal",get:function(){return this.isToggled&&this.toggledCommand?this.toggledCommandVal||"":this.commandVal}},{key:"tagsArray",get:function(){return(this.tagsList||"").replace(/\s*/g,"").toLowerCase().split(",")}}]),o}()},G=function(t){j(o,I(n.LitElement));var e=O(o);function o(){return _(this,o),e.apply(this,arguments)}return o}();function z(){var t=A(["\n          :host {\n            border: var(--rich-text-editor-border-width, 1px) solid\n              var(--rich-text-editor-border-color, #ddd);\n            background-color: var(--rich-text-editor-bg, #ffffff);\n          }\n        "]);return z=function(){return t},t}function F(){var t=A(["\n          :host {\n            position: relative;\n            height: 0;\n            margin: 0 auto;\n            padding: 0;\n            border: none;\n            background-color: none;\n          }\n          #container {\n            display: flex;\n            position: absolute;\n            bottom: 0;\n            margin: 0 auto;\n            padding: 0;\n            border: var(--rich-text-editor-border-width, 1px) solid\n              var(--rich-text-editor-border-color, #ddd);\n            background-color: var(\n              --rich-text-editor-bg,\n              var(--rich-text-editor-bg, #ffffff)\n            );\n          }\n        "]);return F=function(){return t},t}function K(){var t=A([' <div id="container">',"</div> "]);return K=function(){return t},t}window.customElements.define(G.tag,G);var V=function(t){return function(e){j(i,f.SimpleToolbarBehaviors(t));var o=O(i);function i(){var t;return _(this,i),(t=o.call(this)).config=t.defaultConfig,t.clickableElements={},t.breadcrumbsLabel="Select",t.breadcrumbsSelectAllLabel="All",t}return C(i,[{key:"render",value:function(){return this.toolbarTemplate}},{key:"hasBreadcrumbs",get:function(){return!1}},{key:"undoButton",get:function(){return{command:"undo",icon:"undo",label:"Undo",shortcutKeys:"ctrl+z",type:"rich-text-editor-button"}}},{key:"redoButton",get:function(){return{command:"redo",icon:"redo",label:"Redo",shortcutKeys:"ctrl+shift+z",type:"rich-text-editor-button"}}},{key:"historyButtonGroup",get:function(){return{type:"button-group",buttons:[this.undoButton,this.redoButton]}}},{key:"formatButton",get:function(){return{label:"Format",type:"rich-text-editor-heading-picker"}}},{key:"boldButton",get:function(){return{command:"bold",icon:"editor:format-bold",label:"Bold",shortcutKeys:"ctrl+b",toggles:!0,type:"rich-text-editor-button"}}},{key:"italicButton",get:function(){return{command:"italic",icon:"editor:format-italic",label:"Italics",shortcutKeys:"ctrl+i",toggles:!0,type:"rich-text-editor-button"}}},{key:"underlineButton",get:function(){return{type:"rich-text-editor-underline"}}},{key:"removeFormatButton",get:function(){return{command:"removeFormat",icon:"editor:format-clear",label:"Erase Format",type:"rich-text-editor-button"}}},{key:"basicInlineButtonGroup",get:function(){return{type:"button-group",buttons:[this.formatButton,this.boldButton,this.italicButton,this.removeFormatButton]}}},{key:"linkButton",get:function(){return{icon:"link",label:"Link",shortcutKeys:"ctrl+k",type:"rich-text-editor-link"}}},{key:"linkButtonGroup",get:function(){return{type:"button-group",buttons:[this.linkButton]}}},{key:"cutButton",get:function(){return{command:"cut",icon:"content-cut",label:"Cut",shortcutKeys:"ctrl+x",type:"rich-text-editor-button"}}},{key:"copyButton",get:function(){return{command:"copy",icon:"content-copy",label:"Copy",shortcutKeys:"ctrl+c",type:"rich-text-editor-button"}}},{key:"pasteButton",get:function(){return{command:"paste",icon:"content-paste",label:"Paste",shortcutKeys:"ctrl+v",type:"rich-text-editor-button"}}},{key:"clipboardButtonGroup",get:function(){return{type:"button-group",buttons:[this.cutButton,this.copyButton,this.pasteButton]}}},{key:"subscriptButton",get:function(){return{command:"subscript",icon:"mdextra:subscript",label:"Subscript",toggles:!0,type:"rich-text-editor-button"}}},{key:"superscriptButton",get:function(){return{command:"superscript",icon:"mdextra:superscript",label:"Superscript",toggles:!0,type:"rich-text-editor-button"}}},{key:"scriptButtonGroup",get:function(){return{type:"button-group",buttons:[this.subscriptButton,this.superscriptButton]}}},{key:"symbolButton",get:function(){return{symbolTypes:["symbols"],type:"rich-text-editor-symbol-picker"}}},{key:"emojiButton",get:function(){return{type:"rich-text-editor-emoji-picker"}}},{key:"imageButton",get:function(){return{type:"rich-text-editor-image"}}},{key:"insertButtonGroup",get:function(){return{type:"button-group",buttons:[this.imageButton,this.symbolButton]}}},{key:"orderedListButton",get:function(){return{command:"insertOrderedList",icon:"editor:format-list-numbered",label:"Ordered List",toggles:!0,type:"rich-text-editor-button"}}},{key:"unorderedListButton",get:function(){return{command:"insertUnorderedList",icon:"editor:format-list-bulleted",label:"Unordered List",toggles:!0,type:"rich-text-editor-button"}}},{key:"blockquoteButton",get:function(){return{command:"formatBlock",commandVal:"blockquote",label:"Blockquote",icon:"editor:format-quote",shortcutKeys:"ctrl+'",type:"rich-text-editor-button"}}},{key:"indentButton",get:function(){return{command:"indent",icon:"editor:format-indent-increase",label:"Increase Indent",shortcutKeys:"ctrl+]",type:"rich-text-editor-button"}}},{key:"outdentButton",get:function(){return{command:"outdent",icon:"editor:format-indent-decrease",label:"Decrease Indent",shortcutKeys:"ctrl+[",type:"rich-text-editor-button"}}},{key:"listIndentButtonGroup",get:function(){return{type:"button-group",buttons:[this.orderedListButton,this.unorderedListButton,this.blockquoteButton,this.indentButton,this.outdentButton]}}},{key:"saveButton",get:function(){return{command:"save",icon:"save",label:"Save",type:"rich-text-editor-button"}}},{key:"closeButton",get:function(){return{command:"cancel",icon:"close",label:"Cancel",type:"rich-text-editor-button"}}},{key:"saveCloseButtonGroup",get:function(){return{type:"button-group",buttons:[this.saveButton]}}},{key:"sourceButton",get:function(){return{type:"rich-text-editor-source-code"}}},{key:"sourceButtonGroup",get:function(){return{type:"button-group",buttons:[this.sourceButton]}}},{key:"defaultConfig",get:function(){return[this.historyButtonGroup,this.basicInlineButtonGroup,this.linkButtonGroup,this.clipboardButtonGroup,this.scriptButtonGroup,this.insertButtonGroup,this.listIndentButtonGroup]}},{key:"miniConfig",get:function(){return[{type:"button-group",buttons:[this.boldButton,this.italicButton,this.removeFormatButton]},this.linkButtonGroup,this.scriptButtonGroup,{type:"button-group",buttons:[this.orderedListButton,this.unorderedListButton]}]}},{key:"miniTemplate",get:function(){return n.html(K(),N(T(i.prototype),"toolbarTemplate",this))}},{key:"toolbarTemplate",get:function(){return N(T(i.prototype),"toolbarTemplate",this)}}],[{key:"tag",get:function(){return"rich-text-editor-toolbar"}},{key:"miniStyles",get:function(){return[n.css(F())]}},{key:"baseStyles",get:function(){return[].concat(H(N(T(i),"baseStyles",this)),H(m.RichTextStyles),[n.css(z())])}},{key:"styles",get:function(){return[].concat(H(this.baseStyles),H(N(T(i),"stickyStyles",this)))}},{key:"properties",get:function(){return S(S({},N(T(i),"properties",this)),{},{breadcrumbsLabel:{name:"breadcrumbsLabel",type:String,attribute:"breadcrumbs-label"},breadcrumbsSelectAllLabel:{name:"breadcrumbsSelectAllLabel",type:String,attribute:"breadcrumbs-select-all-label"},editor:{name:"editor",type:Object,attribute:"editor"},id:{name:"id",type:String,attribute:"id",reflect:!0},savedSelection:{name:"savedSelection",type:Object},range:{name:"range",type:Object},registered:{type:Boolean},selectedNode:{type:Object},selectionAncestors:{type:Array},show:{type:String,attribute:"show",reflect:!0},clickableElements:{name:"clickableElements",type:Object},__pasteDisabled:{name:"__pasteDisabled",type:Boolean,attribute:"paste-disabled",reflect:!0},__promptOpen:{name:"__promptOpen",type:Boolean},__selection:{type:Object}})}}]),C(i,[{key:"firstUpdated",value:function(t){N(T(i.prototype),"firstUpdated",this).call(this,t),this.__selection=window.RichTextEditorSelection.requestAvailability(),this.register(),this.hasBreadcrumbs&&this._addBreadcrumbs()}},{key:"updated",value:function(t){var e=this;N(T(i.prototype),"updated",this).call(this,t),t.forEach(function(t,n){"range"===n&&e._rangeChange(),"editor"===n&&e._editorChange(),["editor","show","range"].includes(n)&&(e.hidden=e.disconnected),["breadcrumbs","sticky"].includes(n)&&e.breadcrumbs&&(e.breadcrumbs.sticky=e.sticky)})}},{key:"connectedCallback",value:function(){N(T(i.prototype),"connectedCallback",this).call(this),this.register()}},{key:"disconnectedCallback",value:function(){N(T(i.prototype),"disconnectedCallback",this).call(this),this.register(!0)}},{key:"cancel",value:function(){this.dispatchEvent(new CustomEvent("cancel",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"close",value:function(){this.dispatchEvent(new CustomEvent("disableediting",{bubbles:!0,cancelable:!0,composed:!0,detail:this})),this.editor=void 0,document.body.append(this)}},{key:"highlight",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.dispatchEvent(new CustomEvent("highlight",{bubbles:!0,cancelable:!0,composed:!0,detail:t}))}},{key:"register",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];window.dispatchEvent(new CustomEvent("register",{bubbles:!0,cancelable:!0,composed:!0,detail:{remove:t,toolbar:this}}))}},{key:"setRange",value:function(t){this.dispatchEvent(new CustomEvent("setrange",{bubbles:!0,cancelable:!0,composed:!0,detail:{editor:this.editor,range:t}}))}},{key:"selectNode",value:function(t){this.dispatchEvent(new CustomEvent("selectnode",{bubbles:!0,cancelable:!0,composed:!0,detail:t}))}},{key:"selectNodeContents",value:function(t){this.dispatchEvent(new CustomEvent("selectnodecontents",{bubbles:!0,cancelable:!0,composed:!0,detail:t}))}},{key:"selectRange",value:function(t){this.dispatchEvent(new CustomEvent("selectrange",{bubbles:!0,cancelable:!0,composed:!0,detail:t}))}},{key:"newEditor",value:function(t){var e=document.createElement("rich-text-editor");t.parentNode.insertBefore(e,t),e.appendChild(t)}},{key:"pasteFromClipboard",value:function(){this.dispatchEvent(new CustomEvent("pastefromclipboard",{bubbles:!0,cancelable:!0,composed:!0,detail:this.editor}))}},{key:"clearToolbar",value:function(){N(T(i.prototype),"clearToolbar",this)&&N(T(i.prototype),"clearToolbar",this).call(this),this.clickableElements={}}},{key:"deregisterButton",value:function(t){var e=this;N(T(i.prototype),"deregisterButton",this)&&N(T(i.prototype),"deregisterButton",this).call(this,t),(t.tagsArray||[]).forEach(function(t){return delete e.clickableElements[t]})}},{key:"registerButton",value:function(t){var e=this;N(T(i.prototype),"registerButton",this)&&N(T(i.prototype),"registerButton",this).call(this,t),"paste"!==t.command||navigator.clipboard?(t.disabled=!this.editor,(t.tagsArray||[]).forEach(function(n){return e.clickableElements[n]=function(e){return t.tagClickCallback(e)}})):t.remove()}},{key:"_addBreadcrumbs",value:function(){var t=this;this.breadcrumbs||(this.breadcrumbs=document.createElement("rich-text-editor-breadcrumbs"),this.breadcrumbs.onselectnode=function(e){return t._selectNode(e.detail)},document.body.appendChild(this.breadcrumbs),this.breadcrumbs.addEventListener("breadcrumb-click",this._handleBreadcrumb.bind(this))),this.breadcrumbs.label=this.breadcrumbsLabel}},{key:"_handleBreadcrumb",value:function(t){this.editor&&this.range?t.detail.selectAll?this.selectNodeContents(this.editor):this.selectNode(t.detail):this._rangeChange()}},{key:"_handleButtonUpdate",value:function(t){N(T(i.prototype),"_handleButtonUpdate",this)&&N(T(i.prototype),"_handleButtonUpdate",this).call(this,t)}},{key:"_editorChange",value:function(){var t=this;this.breadcrumbs&&(this.breadcrumbs.controls=this.controls,this.editor&&this.editor.parentNode.insertBefore(this.breadcrumbs,this.editor.nextSibling)),this.buttons.forEach(function(e){"close"!==e.command&&(e.disabled=!t.editor)}),this.range=void 0}},{key:"_rangeChange",value:function(){var t=this;if(this.range&&this.range.commonAncestorContainer&&this.editor&&this.editor.contains(this.range.commonAncestorContainer)){var e=this.range.commonAncestorContainer,n=1==e.nodeType?e:e.parentNode,o=[];n!==this.editor&&function e(n){o.push(n),n.parentNode&&n.parentNode!==t.editor&&e(n.parentNode)}(n),o.push({nodeName:this.breadcrumbsSelectAllLabel,selectAll:!0}),this.selectedNode=o[0],this.selectionAncestors=o.reverse(),(this.buttons||[]).forEach(function(e){e.range=void 0,e.range=t.range,e.selectedNode=t.selectedNode,e.selectionAncestors=t.selectionAncestors}),this.breadcrumbs&&(this.breadcrumbs.selectionAncestors=this.selectionAncestors,this.breadcrumbs.hidden=this.disconnected)}}},{key:"controls",get:function(){return this.editor?this.editor.getAttribute("id"):void 0}},{key:"disconnected",get:function(){return"always"!=this.show&&("selection"!=this.show?!this.editor:this.noSelection)}},{key:"noSelection",get:function(){return!this.range||this.range.collapsed}}]),i}()},Q=function(t){j(o,V(n.LitElement));var e=O(o);function o(){return _(this,o),e.apply(this,arguments)}return o}();function W(){var t=A([" "," "]);return W=function(){return t},t}window.customElements.define(Q.tag,Q);var $=function(t){j(o,V(n.LitElement));var e=O(o);function o(){var t;return _(this,o),(t=e.call(this)).sticky=!1,t.config=t.miniConfig,t}return C(o,[{key:"render",value:function(){return n.html(W(),N(T(o.prototype),"miniTemplate",this))}}],[{key:"tag",get:function(){return"rich-text-editor-toolbar-mini"}},{key:"styles",get:function(){return[].concat(H(N(T(o),"baseStyles",this)),H(N(T(o),"miniStyles",this)))}}]),C(o,[{key:"updated",value:function(t){var e=this;N(T(o.prototype),"updated",this).call(this,t),t.forEach(function(t,n){"sticky"===n&&e.sticky&&(e.sticky=!1)})}}]),o}();function J(){var t=A(["\n        :host {\n          display: block;\n          background-color: var(--rich-text-editor-bg, #ffffff);\n          color: var(--rich-text-editor-button-color #444);\n          border: var(--rich-text-editor-border-width, 1px) solid var(--rich-text-editor-border-color, #ddd);\n          padding: 3px 10px;\n        }\n        :host([sticky]) {\n          position: sticky;\n          bottom: 0;\n        }\n        .selectednode {\n          background-color: var(--rich-text-editor-button-bg, #ffffff);\n        }\n        button {\n          display: inline-block;\n          text-align: center;\n          min-width: 25px;\n          margin: 0;\n          padding: 2px 5px;\n        }\n        .selectNode {\n          font-family: monospace;\n        }\n      "]);return J=function(){return t},t}function X(){var t=A([' <span class="divider"> &gt; </span> ']);return X=function(){return t},t}function Y(){var t=A(['\n              <button\n                class="','"\n                controls="','"\n                @click="','"\n                tabindex="0"\n              >\n                ',"\n              </button>\n              ","\n            "]);return Y=function(){return t},t}function Z(){var t=A(["\n      ",":\n      ","\n    "]);return Z=function(){return t},t}window.customElements.define($.tag,$);var tt=function(t){j(o,n.LitElement);var e=O(o);function o(){var t;return _(this,o),(t=e.call(this)).hidden=!0,t.sticky=!1,t.label="Select",t}return C(o,null,[{key:"tag",get:function(){return"rich-text-editor-breadcrumbs"}},{key:"properties",get:function(){return{controls:{type:String},hidden:{type:Boolean,attribute:"hidden",reflect:!0},label:{type:String},sticky:{type:Boolean,reflect:!0},selectionAncestors:{type:Array}}}}]),C(o,[{key:"_handleClick",value:function(t){this.dispatchEvent(new CustomEvent("breadcrumb-click",{bubbles:!0,cancelable:!0,composed:!0,detail:t}))}},{key:"render",value:function(){var t=this;return n.html(Z(),this.label,this.selectionAncestors?(this.selectionAncestors||[]).map(function(e,o){return n.html(Y(),e.selectAll?"":"selectnode",t.controls,function(n){return t._handleClick(e)},e.nodeName.toLowerCase(),o+1>=(t.selectionAncestors||[]).length?"":n.html(X()))}):"")}}],[{key:"styles",get:function(){return[].concat(H(m.RichTextToolbarStyles),[n.css(J())])}}]),o}();window.customElements.define(tt.tag,tt);var et=function(t){j(o,V(n.LitElement));var e=O(o);function o(){return _(this,o),e.call(this)}return C(o,[{key:"render",value:function(){return N(T(o.prototype),"render",this).call(this)}}],[{key:"tag",get:function(){return"rich-text-editor-toolbar-full"}},{key:"styles",get:function(){return[].concat(H(N(T(o),"baseStyles",this)),H(N(T(o),"stickyStyles",this)))}},{key:"properties",get:function(){return S({},N(T(o),"properties",this))}}]),C(o,[{key:"hasBreadcrumbs",get:function(){return!0}}]),o}();function nt(){var t=A(["\n        :host {\n  background-color: var(--rich-text-editor-selection-bg, rgb(146, 197, 255));\n          margin: 0;\n          padding: 0;\n          display: inline-block;\n        }\n        :host([hidden]) {\n          display: none;\n        }\n        :host([collapsed]):after {\n          content: '|';\n          color: var(--simple-toolbar-selection-bg);\n          background-color: transparent;\n        }\n        :host + *,\n        ::slotted(*) {\n  background-color: var(--rich-text-editor-selection-bg, rgb(146, 197, 255));\n        }\n      "]);return nt=function(){return t},t}function ot(){var t=A(["<slot></slot>"]);return ot=function(){return t},t}window.customElements.define(et.tag,et);var it=function(t){j(o,n.LitElement);var e=O(o);function o(){var t;_(this,o);var n=R(t=e.call(this));return t.hidden=!0,t.__toolbars=[],t.__clipboard=document.createElement("textarea"),t.__clipboard.setAttribute("aria-hidden",!0),t.__clipboard.style.position="absolute",t.__clipboard.style.left="-9999px",t.__clipboard.style.top="0px",t.__clipboard.style.width="0px",t.__clipboard.style.height="0px",t.id=t._generateUUID(),document.body.appendChild(t.__clipboard),window.addEventListener("register",t._handleRegistration.bind(n)),t}return C(o,[{key:"validCommands",get:function(){return["backColor","bold","copy","createLink","cut","decreaseFontSize","defaultParagraphSeparator","delete","fontName","fontSize","foreColor","formatBlock","forwardDelete","hiliteColor","increaseFontSize","indent","insertBrOnReturn","insertHorizontalRule","insertHTML","insertImage","insertLineBreak","insertOrderedList","insertUnorderedList","insertParagraph","insertText","italic","justifyCenter","justifyFull","justifyLeft","justifyRight","outdent","paste","redo","removeFormat","selectAll","strikethrough","styleWithCss","subscript","superscript","undo","unlink","useCSS"]}}]),C(o,[{key:"render",value:function(){return n.html(ot())}},{key:"updated",value:function(t){N(T(o.prototype),"updated",this).call(this,t),t.forEach(function(t,e){})}},{key:"disconnectedCallback",value:function(){N(T(o.prototype),"disconnectedCallback",this).call(this)}},{key:"cancelEdits",value:function(t){t.revert(),this.edit(t,!1)}},{key:"closeToolbar",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.editor;e&&this.disableEditing(e),t.editor=void 0,document.body.append(t)}},{key:"disableEditing",value:function(t){t&&(this.getRoot(t).onselectionchange=void 0,t.viewSource=!1,t.disableEditing(),t.makeSticky(!1))}},{key:"edit",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=t?this.getConnectedToolbar(t):void 0,o=e?n.editor:void 0;this.highlight(n,!1),n&&o!==t&&(o&&this.disableEditing(o),n.editor=t,this.enableEditing(t,n))}}},{key:"enableEditing",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getConnectedToolbar(t);t&&(t.makeSticky(n.sticky),t.parentNode.insertBefore(n,t),t.enableEditing(),this.updateRange(t),this.getRoot(t).onselectionchange=function(o){n.__promptOpen||e.updateRange(t)})}},{key:"expandRangeTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=e?this.getRangeNode(e):void 0,o=n&&n.tagName?n.tagName.toLowerCase():void 0;return t.toLowerCase().replace(/\s*/g,"").split(",").includes(o)?n:n.closest(t)?(e.selectNode(n.closest(t)),e):void 0}},{key:"getRangeNode",value:function(t){var e=t?t.commonAncestorContainer:void 0,n=t?t.startContainer:void 0,o=t?t.startOffset:void 0,i=t?t.endContainer:void 0,r=t?t.endOffset:void 0,a=n&&n.children?n.children[o-1]:void 0;return n===i&&r-o==1?a:e}},{key:"getRoot",value:function(t){return t&&t!==document?t.parentNode?this.getRoot(t.parentNode):t:document}},{key:"getConnectedToolbar",value:function(t){if(t.id||(t.id=this._generateUUID()),!t.__connectedToolbar){var e,n=t.toolbar?(this.__toolbars||[]).filter(function(e){return t.toolbar&&e.id===t.toolbar}):[];0===n.length&&(n=t.type?(this.__toolbars||[]).filter(function(e){return t.type&&e.type===t.type}):[]),0===n.length&&(n=this.__toolbars),n[0]?e=n[0]:0===n.length&&(e=document.createElement(t.type||"rich-text-editor-toolbar"),t.parentNode.insertBefore(e,t)),e.id=e.id||t.toolbar||this._generateUUID(),t.__connectedToolbar=e}return t.__connectedToolbar}},{key:"highlight",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;this.toolbar=t,(t?t.editor:void 0)&&(!1!==e?t.range&&(this.hidden=!1,t.range.insertNode(this),n&&this.append(n),t.range.setStartAfter(this),this.range=t.range):(this.updateRange(t.editor,t.range),this.hidden=!0,this.toolbar=void 0,this.range=void 0,document.body.appendChild(this)),this.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!0,composed:!0,detail:e})))}},{key:"highlightNode",value:function(t,e){this.selectNode(t,e.range,e.editor),this.highlight(e)}},{key:"pasteFromClipboard",value:function(t){var e=this;setTimeout(w(regeneratorRuntime.mark(function n(){var o,i,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=window.getSelection(),i=t.range,n.next=4,navigator.clipboard.readText();case 4:r=n.sent,e.__clipboard.value=r,e.__clipboard.focus(),e.__clipboard.select(),document.execCommand("paste"),o.removeAllRanges(),o.addRange(i),e.pasteIntoEditor(t,e.__clipboard.value);case 12:case"end":return n.stop()}},n)})),2e3)}},{key:"pasteIntoEditor",value:function(t,e){if(t){var n=t.range,o=document.createElement("div");if(t=n.commonAncestorContainer.parentNode.closest("[editing=true]:not([disabled]),input:not([disabled]),textarea:not([disabled])")){for(o.innerHTML=t.sanitizeHTML(e),n&&n.extractContents&&n.extractContents(),n.insertNode(o);o.firstChild;)o.parentNode.insertBefore(o.firstChild,o);o.parentNode.removeChild(o)}}}},{key:"registerEditor",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t?this.getConnectedToolbar(t):void 0,i={click:function(n){return e._handleEditorClick(t,n)},focus:function(n){o.__promptOpen||t.disabled||e.edit(t)},getrange:function(n){o.__promptOpen||(e.toolbar=o,e.updateRange(t,t.range))},keydown:function(n){return e._handleShortcutKeys(t,n)},pastefromclipboard:function(t){return e.pasteFromClipboard(t.detail)},pastecontent:function(t){return e._handlePaste(t)}};return n?Object.keys(i).forEach(function(e){return t.removeEventListener(e,i[e])}):Object.keys(i).forEach(function(e){return t.addEventListener(e,i[e])}),(t.__connectedToolbar.show=!t.__connectedToolbar.editor)&&this.edit(t),t.__connectedToolbar}},{key:"registerToolbar",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={command:function(n){n.stopImmediatePropagation();var o=n.detail||{};e._handleCommand(t,o.command,o.commandVal,o.range),o.button&&o.button.commandCallback&&o.button.commandCallback(t.editor,t,e)},disableediting:function(t){return e.disableEditing((t.detail||{}).editor)},highlight:function(n){e.highlight(t,n.detail)},highlightnode:function(n){e.highlightNode(n.detail,t)},pastefromclipboard:function(t){t.stopImmediatePropagation(),e.pasteFromClipboard(t.detail)},"rich-text-editor-prompt-closed":function(e){t.__promptOpen=!1},"rich-text-editor-prompt-open":function(e){t.__promptOpen=!0},setrange:function(t){e.range=(t.detail||{}).range,e.updateRange((t.detail||{}).editor,e.range),e.selectRange(e.range,(t.detail||{}).editor)},selectnode:function(n){e.selectNode(n.detail,t.range,t.editor)},selectnodecontents:function(n){e.selectNodeContents(n.detail,t.range,t.editor)},selectrange:function(n){e.selectRange(n.detail,t.editor)},wrapselection:function(n){e.surroundRange(n.detail,t.range)}};n||t.registered?(t.registered=!1,Object.keys(o).forEach(function(e){return t.removeEventListener(e,o[e])})):(this.__toolbars.push(t),Object.keys(o).forEach(function(e){return t.addEventListener(e,o[e])}),t.registered=!0)}},{key:"selectNode",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.toolbar.editor;if(!e){var o=window.getSelection();e=document.createRange(),o.removeAllRanges(),o.addRange(e)}e&&(e.selectNode(t),n&&this.updateRange(n,e))}},{key:"selectNodeContents",value:function(t,e,n){if(t){if(!e){var o=window.getSelection();e=document.createRange(),o.removeAllRanges(),o.addRange(e)}e&&(e.selectNodeContents(t),n&&this.updateRange(n,e))}}},{key:"selectRange",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;if(t){if(e){var o=window.getSelection();o.removeAllRanges(),o.addRange(t)}else t.isCollapsed||t.collapse();n&&this.updateRange(n)}return t}},{key:"surroundRange",value:function(t,e){return e&&(e.surroundContents(t),editor&&this.updateRange(editor)),e}},{key:"updateRange",value:function(t,e){if(t){var n=this.getConnectedToolbar(t);this.toolbar=n,e||(e=t.range),t.range=e,n&&(n.selectedNode=t.selectedNode,n.selectionAncestors=t.selectionAncestors,n.range=e)}}},{key:"_generateUUID",value:function(){var t=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return"rte-"+"ss-s-s-s-sss".replace(/s/g,t)}},{key:"_handleBlur",value:function(t,e){null===e.relatedTarget||"rich-text-editor"===!e.relatedTarget.startsWith?this.edit(t,!0):t&&this.highlight(t.toolbar)}},{key:"_handleCommand",value:function(t,e,n,o){var i=t.editor;this.validCommands.includes(e)?(n=i?i.sanitizeHTML(n):n,this.range=i.range,this.updateRange(i,o),this.selectRange(o,i),"paste"!=e?document.execCommand(e,!1,n):navigator.clipboard&&this.pasteFromClipboard(i),this.highlight(t,!1)):"cancel"===e?(i&&i.revert(),t.close(i)):"close"===e&&t.close(i)}},{key:"_handleEditorClick",value:function(t,e){if(t&&!t.disabled){var n=this.getConnectedToolbar(t),o=t.__focused;if(n&&n.editor===t||this.edit(t),t.focus(),o){var i=n?Object.keys(n.clickableElements||{}):[],r=e.target||e.srcElement||{tagName:""},a={detail:r},s=(r.tagName||"").toLowerCase();s&&i.includes(s)&&(console.log(r),e.preventDefault(),n.clickableElements[s](a))}}}},{key:"_handleRegistration",value:function(t){t.detail&&(t.detail.toolbar&&this.registerToolbar(t.detail.toolbar,t.detail.remove),t.detail.editor&&this.registerEditor(t.detail.editor,t.detail.remove))}},{key:"_handleShortcutKeys",value:function(t,e){var n=t?this.getConnectedToolbar(t):void 0;t.editing&&n._handleShortcutKeys(e)}}],[{key:"tag",get:function(){return"rich-text-editor-selection"}},{key:"properties",get:function(){return{editor:{type:Object},collapsed:{type:Boolean,reflect:!0,attribute:"collapsed"},hidden:{type:Boolean,reflect:!0,attribute:"hidden"},id:{type:String,reflect:!0,attribute:"id"},observer:{type:Object},range:{type:Object},toolbar:{type:Object},__toolbars:{type:Array}}}},{key:"styles",get:function(){return[n.css(nt())]}}]),o}();function rt(){var t=A(["\n          :host {\n            display: block;\n          }\n          :host([hidden]) {\n            display: none;\n          }\n          :host([disabled]) {\n            cursor: not-allowed;\n          }\n          :host(:empty) {\n            opacity: 0.7;\n          }\n          :host(:focus) {\n            outline: none;\n          }\n\n          :host(.heightmax[editing]) {\n            max-height: calc(100vh - 200px);\n            overflow-y: scroll;\n          }\n\n          #container,\n          #wysiwyg {\n            display: block;\n            width: 100%;\n          }\n          #source,\n          #wysiwyg {\n            margin: 0;\n            padding: 0;\n            min-height: var(--rich-text-editor-min-height, 20px);\n            cursor: pointer;\n            outline: none;\n            flex: 1 1 100%;\n            width: 100%;\n          }\n          :host(:empty) #wysiwyg::after {\n            display: block;\n            content: attr(aria-placeholder);\n          }\n\n          :host(:hover),\n          :host(:focus-within) {\n            opacity: 1;\n            outline: var(--rich-text-editor-border-width, 1px) solid\n              var(--rich-text-editor-focus-color, blue);\n          }\n          :host([disabled]),\n          :host([view-source]) {\n            outline: none !important;\n          }\n\n          #source:hover,\n          #source:focus-within {\n            outline: var(--rich-text-editor-border-width, 1px) solid\n              var(--rich-text-editor-focus-color, blue);\n          }\n          :host([editing][view-source]) #container {\n            display: flex;\n            align-items: stretch;\n            justify-content: space-between;\n            width: 100%;\n          }\n          :host([editing][view-source]) #source,\n          :host([editing][view-source]) #wysiwyg {\n            resize: horizontal;\n            overflow: auto;\n            flex: 1 1 auto;\n            width: 50%;\n          }\n          :host([editing][view-source]) #source {\n            min-width: 300px;\n          }\n          :host([editing][view-source]) #wysiwyg {\n            cursor: not-allowed;\n            margin-right: 10px;\n            width: calc(50% - 10px);\n          }\n        "]);return rt=function(){return t},t}function at(){var t=A([' <div\n        id="container"\n        @focus="','"\n        @blur="','"\n        @mouseover="','"\n        @mouseout="','"\n      >\n        <div id="wysiwyg" aria-placeholder="','">\n          <slot></slot>\n        </div>\n        <code-editor\n          id="source"\n          font-size="13"\n          ?hidden="','"\n          language="html"\n          @value-changed="','"\n          word-wrap\n        >\n        </code-editor>\n      </div>']);return at=function(){return t},t}window.customElements.define(it.tag,it),window.RichTextEditorSelection={},window.RichTextEditorSelection.instance=null,window.RichTextEditorSelection.requestAvailability=function(){return null==window.RichTextEditorSelection.instance&&(window.RichTextEditorSelection.instance=document.createElement(it.tag),document.body.appendChild(window.RichTextEditorSelection.instance)),window.RichTextEditorSelection.instance};var st=function(t){return function(e){j(r,t);var i=O(r);function r(){var t;_(this,r),(t=i.call(this)).placeholder="Click to edit",t.toolbar="",t.type="rich-text-editor-toolbar",t.id="",t.range=void 0,t.disabled=!1,t.__focused=!1,t.__hovered=!1,t.editing=!1,t.__selection=window.RichTextEditorSelection.requestAvailability();var e=R(t);return t.setAttribute("tabindex",1),document.addEventListener(o.eventName,t._getRange.bind(e)),t}return C(r,[{key:"render",value:function(){var t=this;return n.html(at(),function(e){return t.__focused=!0},function(e){return t.__focused=!1},function(e){return t.__hovered=!0},function(e){return t.__hovered=!1},this.placeholder,!(this.viewSource&&this.editing),this._handleSourceChange)}}],[{key:"styles",get:function(){return[].concat(H(U),[n.css(rt())])}},{key:"properties",get:function(){return S(S({},N(T(r),"properties",this)),{},{id:{name:"id",type:String,reflect:!0,attribute:"id"},editing:{name:"editing",type:Boolean,reflect:!0,attribute:"editing"},disabled:{name:"disabled",type:Boolean,attribute:"disabled",reflect:!0},disableHover:{name:"disableHover",type:Boolean,attribute:"disable-hover"},placeholder:{name:"placeholder",type:String,reflect:!0,attribute:"placeholder"},toolbar:{name:"toolbar",type:String,reflect:!0,attribute:"toolbar"},range:{name:"range",type:Object,attribute:"range"},rawhtml:{type:String,attribute:"rawhtml"},type:{name:"type",type:String,reflect:!0,attribute:"type"},updateRange:{type:Boolean},viewSource:{type:Boolean,attribute:"view-source",reflect:!0},__canceledEdits:{type:Object},__connectedToolbar:{type:Object},__codeEditorValue:{type:String},__needsUpdate:{type:Boolean},__focused:{type:Boolean},__hovered:{type:Boolean},__selection:{type:Object}})}},{key:"tag",get:function(){return"rich-text-editor"}}]),C(r,[{key:"connectedCallback",value:function(){var t=this;N(T(r.prototype),"connectedCallback",this).call(this),setTimeout(function(){t.register()},500)}},{key:"disconnectedCallback",value:function(){N(T(r.prototype),"disconnectedCallback",this).call(this),this.register(!0)}},{key:"firstUpdated",value:function(){N(T(r.prototype),"firstUpdated",this)&&N(T(r.prototype),"firstUpdated",this).call(this),this.isEmpty()&&this.rawhtml?this.setHTML(this.rawhtml):(this.isEmpty()&&(this.innerHTML=""),this._editableChange())}},{key:"updated",value:function(t){var e=this;N(T(r.prototype),"updated",this).call(this,t),t.forEach(function(t,n){"editing"===n&&e._editableChange(),"disabled"===n&&(e.disableEditing(),e.setAttribute("tabindex",e.disabled?-1:0)),"range"===n&&e._rangeChange(),"rawhtml"===n&&e.rawhtml&&e.setHTML(e.rawhtml),"viewSource"===n&&e._handleViewSourceChange(),["viewSource","editing"].includes(n)&&(e.editing&&!e.viewSource?e.setAttribute("contenteditable",!0):e.removeAttribute("contentEditable"))}),this.innerHTML||(this.innerHTML="")}},{key:"disableEditing",value:function(){this.editing=!1,this.dispatchEvent(new CustomEvent("editing-disabled",{bubbles:!0,composed:!0,cancelable:!0,detail:(this.innerHTML||"").replace(/<!--[^(-->)]*-->/g,"").trim()}))}},{key:"enableEditing",value:function(){this.editing=!0,this.dispatchEvent(new CustomEvent("editing-enabled",{bubbles:!0,composed:!0,cancelable:!0,detail:(this.innerHTML||"").replace(/<!--[^(-->)]*-->/g,"").trim()}))}},{key:"focus",value:function(){this.disabled||(this.__focused=!0),this.dispatchEvent(new CustomEvent("focus",{bubbles:!0,composed:!0,cancelable:!0,detail:this.querySelector("*")}))}},{key:"getHTML",value:function(){return this.isEmpty()?"":(this.innerHTML||"").replace(/<!--[^(-->)]*-->/g,"").trim()}},{key:"isEmpty",value:function(){return!this.innerHTML||""==this.trimHTML(this)}},{key:"makeSticky",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this.classList.remove("heightmax"):this.classList.add("heightmax")}},{key:"observeChanges",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this.observer.observe(this,{attributes:!1,childList:!0,subtree:!0,characterData:!1}):this.observer&&this.observer.disconnect}},{key:"paste",value:function(t){this._handlePaste(t)}},{key:"register",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];window.dispatchEvent(new CustomEvent("register",{bubbles:!0,cancelable:!0,composed:!0,detail:{remove:t,editor:this}}))}},{key:"revert",value:function(){this.innerHTML=this.__canceledEdits}},{key:"rootNode",value:function(){return this.__selection?this.__selection.getRoot(this):document}},{key:"sanitizeHTML",value:function(t){if(t){var e="<body(.*\n)*>(.*\n)*</body>";return t.match(e)&&t.match(e).length>0&&(t=t.match(e)[0].replace(/<\?body(.*\n)*\>/i)),t}}},{key:"setHTML",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.sanitizeHTML(t).trim();this.innerHTML=e,this.setCancelHTML(e),this.isEmpty()&&(this.innerHTML=""),this._editableChange()}},{key:"setCancelHTML",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.innerHTML;this.__canceledEdits=t||""}},{key:"trimHTML",value:function(t){var e=t?t.innerHTML:void 0;return this.trimString(e)}},{key:"trimString",value:function(t){return(t||"").replace(/<!--[^(-->)]*-->/g,"").replace(/[\s\t\r\n]/gim,"")}},{key:"updateRange",value:function(){this.dispatchEvent(new CustomEvent("getrange",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"_editableChange",value:function(){var t=this,e=function(e){if(t.isEmpty()&&e.key){t.innerHTML=e.key.replace(">","&gt;").replace("<","&lt;").replace("&","&amp;");t._getRange();t.range.selectNodeContents(t),t.range.collapse()}};this.editing?(this.addEventListener("keypress",e),this.setCancelHTML()):this.removeEventListener("keypress",e)}},{key:"_getRange",value:function(){var t=function t(e){var n=e.parentNode;return n?t(n):e};return this.range=t(this)?o.getRange(t(this)):void 0,this.updateRange&&this.updateRange(),this.range}},{key:"_handlePaste",value:function(t){t&&(t.clipboardData||t.originalEvent.clipboardData)?(t.originalEvent||t).clipboardData.getData("text/html"):window.clipboardData&&window.clipboardData.getData("Text"),this.dispatchEvent(new CustomEvent("pastefromclipboard",{bubbles:!0,cancelable:!0,composed:!0,detail:this})),t.preventDefault()}},{key:"_handleSourceChange",value:function(t){var e=this;if(!this.__needsUpdate){var n="".concat(this.innerHTML),o=t.detail.value?"".concat(t.detail.value):n,i=this._outdentHTML(o).replace(/\s+/gm,""),r=this._outdentHTML(n).replace(/\s+/gm,"");this.__needsUpdate=i.localeCompare(r);this.__needsUpdate&&setTimeout(function(){e.__needsUpdate=!1,e.innerHTML=t.detail.value}.bind(this),300)}}},{key:"_outdentHTML",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=(t=this.sanitizeHTML(t).replace(/[\s]*$/,"").replace(/^[\n\r]*/,"").replace(/[\n\r]+/gm,"\n")).match(/^\s+/),n=!!e&&e[0],o=!!n&&new RegExp("\\n".concat(n),"gm");return t=t.replace(/^\s+/,""),t=o?t.replace(o,"\n "):t}},{key:"_handleViewSourceChange",value:function(t){var e=this.shadowRoot?this.shadowRoot.querySelector("#source"):void 0;e&&this.viewSource?(e.editorValue=this._outdentHTML(this.innerHTML),e.addEventListener("value-changed",this._handleSourceChange.bind(this))):e&&e.removeEventListener("value-changed",this._handleSourceChange.bind(this))}},{key:"_rangeChange",value:function(t){}},{key:"observer",get:function(){return new MutationObserver(this._getRange)}}]),r}()},ct=function(t){j(o,st(n.LitElement));var e=O(o);function o(){return _(this,o),e.apply(this,arguments)}return o}();window.customElements.define(ct.tag,ct),t.RichTextEditor=ct,t.RichTextEditorBehaviors=st,Object.defineProperty(t,"__esModule",{value:!0})});
