!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("lit"),require("@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-button.js"),require("@lrnwebcomponents/rich-text-editor/lib/singletons/rich-text-editor-range-behaviors.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icons.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-button-lite.js"),require("@lrnwebcomponents/hax-iconset/lib/simple-hax-iconset.js"),require("@lrnwebcomponents/simple-toolbar/simple-toolbar"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-link.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-image.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-underline.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-symbol-picker.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-heading-picker.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-source-code.js"),require("@lrnwebcomponents/simple-toolbar/simple-toolbar.js"),require("@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-button.js"),require("@lrnwebcomponents/rich-text-editor/lib/singletons/rich-text-editor-prompt.js"),require("@lrnwebcomponents/absolute-position-behavior/absolute-position-behavior.js"),require("shadow-selection-polyfill/shadow.js")):"function"==typeof define&&define.amd?define(["exports","lit","@lrnwebcomponents/simple-toolbar/lib/simple-toolbar-button.js","@lrnwebcomponents/rich-text-editor/lib/singletons/rich-text-editor-range-behaviors.js","@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js","@lrnwebcomponents/simple-icon/lib/simple-icons.js","@lrnwebcomponents/simple-icon/lib/simple-icon-button-lite.js","@lrnwebcomponents/hax-iconset/lib/simple-hax-iconset.js","@lrnwebcomponents/simple-toolbar/simple-toolbar","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-link.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-image.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-underline.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-symbol-picker.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-heading-picker.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-source-code.js","@lrnwebcomponents/simple-toolbar/simple-toolbar.js","@lrnwebcomponents/rich-text-editor/lib/buttons/rich-text-editor-button.js","@lrnwebcomponents/rich-text-editor/lib/singletons/rich-text-editor-prompt.js","@lrnwebcomponents/absolute-position-behavior/absolute-position-behavior.js","shadow-selection-polyfill/shadow.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).RichTextEditor={},t.lit,t.simpleToolbarButton_js,t.richTextEditorRangeBehaviors_js,null,null,null,null,null,null,null,null,null,null,null,t.simpleToolbar_js,t.richTextEditorButton_js,null,null,t.shadow)}(this,(function(t,e,n,r,o,i,a,s,c,l,u,d,h,b,p,g,m,f,y,v){"use strict";function k(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var x,w,_=k(v);function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){O(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),t}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?A(t):e}function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L(t);if(e){var o=L(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return H(this,n)}}function M(t,e,n){return(M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function P(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function q(t){return function(t){if(Array.isArray(t))return I(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return I(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var U,D,G,K,V=[e.css(x||(x=P(["\n    :host {\n      --simple-toolbar-border-color: var(--rich-text-editor-border-color, #ddd);\n      --simple-toolbar-border-width: var(--rich-text-editor-border-width, 1px);\n      --simple-toolbar-button-bg: var(--rich-text-editor-bg, #ffffff);\n      --simple-fields-focus-color: var(--rich-text-editor-focus-color, blue);\n      --simple-fields-invalid-color: var(--rich-text-editor-error-color, #800);\n    }\n  "])))],F=[].concat(V,[e.css(w||(w=P(["\n    :host {\n      --simple-toolbar-border-color: var(--rich-text-editor-border-color, #ddd);\n      --simple-toolbar-border-width: var(--rich-text-editor-border-width, 1px);\n      --simple-toolbar-button-opacity: var(\n        --rich-text-editor-button-opacity,\n        1\n      );\n      --simple-toolbar-button-color: var(--rich-text-editor-button-color, #444);\n      --simple-toolbar-button-bg: var(--rich-text-editor-button-bg, #ffffff);\n      --simple-toolbar-button-border-color: var(\n        --rich-text-editor-button-border-color,\n        transparent\n      );\n      --simple-toolbar-button-toggled-opacity: var(\n        --rich-text-editor-button-toggled-opacity,\n        1\n      );\n      --simple-toolbar-button-toggled-color: var(\n        --rich-text-editor-button-toggled-color,\n        #222\n      );\n      --simple-toolbar-button-toggled-bg: var(\n        --rich-text-editor-button-toggled-bg,\n        #ddd\n      );\n      --simple-toolbar-button-toggled-border-color: var(\n        --rich-text-editor-button-toggled-border-color,\n        transparent\n      );\n      --simple-toolbar-button-hover-opacity: var(\n        --rich-text-editor-button-hover-opacity,\n        1\n      );\n      --simple-toolbar-button-hover-color: var(\n        --rich-text-editor-button-hover-color,\n        #000\n      );\n      --simple-toolbar-button-hover-bg: var(\n        --rich-text-editor-button-hover-bg,\n        #f0f0f0\n      );\n      --simple-toolbar-button-hover-border-color: var(\n        --rich-text-editor-button-hover-border-color,\n        unset\n      );\n      --simple-toolbar-button-disabled-opacity: var(\n        --rich-text-editor-button-disabled-opacity,\n        1\n      );\n      --simple-toolbar-button-disabled-color: var(\n        --rich-text-editor-button-disabled-color,\n        #666\n      );\n      --simple-toolbar-button-disabled-bg: var(\n        --rich-text-editor-button-disabled-bg,\n        transparent\n      );\n      --simple-toolbar-button-disabled-border-color: var(\n        --rich-text-editor-button-disabled-border-color,\n        transparent\n      );\n    }\n  "])))]),z=function(t){S(n,t);var e=N(n);function n(){return T(this,n),e.apply(this,arguments)}return n}((U=e.LitElement,function(t){S(n,t);var e=N(n);function n(){var t;return T(this,n),(t=e.call(this)).tagsList="",t}return j(n,[{key:"render",value:function(){return M(L(n.prototype),"render",this).call(this)}},{key:"isToggled",get:function(){return this.commandIsToggled}},{key:"operationCommand",get:function(){return this.isToggled&&this.toggledCommand?this.toggledCommand:this.command}},{key:"operationCommandVal",get:function(){return this.isToggled&&this.toggledCommand?this.toggledCommandVal||"":this.commandVal}},{key:"tagsArray",get:function(){return(this.tagsList||"").replace(/\s*/g,"").toLowerCase().split(",")}},{key:"firstUpdated",value:function(t){M(L(n.prototype),"firstUpdated",this)&&M(L(n.prototype),"firstUpdated",this).call(this,t)}},{key:"updated",value:function(t){var e=this;M(L(n.prototype),"updated",this).call(this,t),t.forEach((function(t,n){"controls"===n&&e._editorChanged(e.controls,t),"range"===n&&e._rangeChanged(e.range,t),["shortcutKeys","tagsList","tagClickCallback"].includes(n)&&e.updateButtonRegistry()}))}},{key:"connectedCallback",value:function(){M(L(n.prototype),"connectedCallback",this).call(this)}},{key:"disconnectedCallback",value:function(){M(L(n.prototype),"disconnectedCallback",this).call(this)}},{key:"commandCallback",value:function(t,e,n){}},{key:"tagClickCallback",value:function(t){}},{key:"wrapSelection",value:function(t){this.dispatchEvent(new CustomEvent("wrapselection",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}},{key:"sendCommand",value:function(t){this._handleCommand(this.operationCommand,this.operationCommandVal,this.range),this.commandCallback&&this.commandCallback(this.target,this.__toolbar,this),this.dispatchEvent(new CustomEvent("command",{bubbles:!0,cancelable:!0,composed:!0,detail:{command:this.operationCommand,commandVal:this.operationCommandVal,range:this.range,button:this}}))}},{key:"setRange",value:function(){if(this.tagsList&&""!==this.tagsList){var t=this.rangeOrMatchingAncestor();t&&this.selectNode(t)}}},{key:"_handleClick",value:function(t){t.preventDefault(),this.sendCommand(t)}},{key:"_editorChanged",value:function(t,e){}},{key:"_getSelection",value:function(){return"formatBlock"===this.command?this.rangeOrMatchingAncestor():this._getSelectedHtml()}},{key:"_getSelectedHtml",value:function(){if(this.range){var t,e=document.createElement("div"),n=this.range.cloneContents();return e.appendChild(n),t=e.innerHTML,e.remove(),t?t.trim():void 0}}},{key:"_getSelectedTag",value:function(){var t=this.rangeOrMatchingAncestor();return!(!t||!t.tagName)&&t.tagName.toLowerCase()}},{key:"_getSelectionType",value:function(){return"formatBlock"===this.command?this._getSelectedTag():this._getSelectedHtml()}},{key:"_rangeChanged",value:function(t,e){}}],[{key:"tag",get:function(){return"rich-text-editor-button"}},{key:"styles",get:function(){return[].concat(q(M(L(n),"styles",this)),q(F))}},{key:"properties",get:function(){return E(E({},M(L(n),"properties",this)),{},{command:{type:String,reflect:!0,attribute:"command"},commandVal:{attribute:"command-val",type:Object},tagsList:{type:String},target:{type:Object},toggledCommand:{attribute:"toggled-command",type:String,reflect:!0},toggledCommandVal:{attribute:"toggled-command-val",type:Object},selectedNode:{type:Object},selectionAncestors:{type:Array}})}}]),n}(r.RichTextEditorRangeBehaviors(n.SimpleToolbarButtonBehaviors(U)))));window.customElements.define(z.tag,z),window.RichTextEditorToolbars=window.RichTextEditorToolbars||[];var $,J=function(t){return function(t){S(r,t);var n=N(r);function r(){var t;return T(this,r),(t=n.call(this)).config=t.defaultConfig,t.clickableElements={},t.breadcrumbsLabel="Select",t.breadcrumbsSelectAllLabel="All",t.__toolbar=A(t),document.addEventListener(_.eventName,t._handleTargetSelection.bind(t.__toolbar)),t}return j(r,[{key:"undoButton",get:function(){return{command:"undo",icon:"undo",label:"Undo",shortcutKeys:"ctrl+z",type:"rich-text-editor-button"}}},{key:"redoButton",get:function(){return{command:"redo",icon:"redo",label:"Redo",shortcutKeys:"ctrl+shift+z",type:"rich-text-editor-button"}}},{key:"historyButtonGroup",get:function(){return{type:"button-group",buttons:[this.undoButton,this.redoButton]}}},{key:"formatButton",get:function(){return{label:"Format",type:"rich-text-editor-heading-picker"}}},{key:"boldButton",get:function(){return{command:"bold",icon:"editor:format-bold",label:"Bold",shortcutKeys:"ctrl+b",toggles:!0,type:"rich-text-editor-button"}}},{key:"italicButton",get:function(){return{command:"italic",icon:"editor:format-italic",label:"Italics",shortcutKeys:"ctrl+i",toggles:!0,type:"rich-text-editor-button"}}},{key:"underlineButton",get:function(){return{type:"rich-text-editor-underline"}}},{key:"removeFormatButton",get:function(){return{command:"removeFormat",icon:"editor:format-clear",label:"Erase Format",type:"rich-text-editor-button"}}},{key:"basicInlineButtonGroup",get:function(){return{type:"button-group",buttons:[this.formatButton,this.boldButton,this.italicButton,this.removeFormatButton]}}},{key:"linkButton",get:function(){return{icon:"link",label:"Link",shortcutKeys:"ctrl+k",type:"rich-text-editor-link"}}},{key:"linkButtonGroup",get:function(){return{type:"button-group",buttons:[this.linkButton]}}},{key:"cutButton",get:function(){return{command:"cut",icon:"content-cut",label:"Cut",shortcutKeys:"ctrl+x",type:"rich-text-editor-button"}}},{key:"copyButton",get:function(){return{command:"copy",icon:"content-copy",label:"Copy",shortcutKeys:"ctrl+c",type:"rich-text-editor-button"}}},{key:"pasteButton",get:function(){return{command:"paste",icon:"content-paste",label:"Paste",shortcutKeys:"ctrl+v",type:"rich-text-editor-button"}}},{key:"clipboardButtonGroup",get:function(){return{type:"button-group",buttons:[this.cutButton,this.copyButton,this.pasteButton]}}},{key:"subscriptButton",get:function(){return{command:"subscript",icon:"mdextra:subscript",label:"Subscript",toggles:!0,type:"rich-text-editor-button"}}},{key:"superscriptButton",get:function(){return{command:"superscript",icon:"mdextra:superscript",label:"Superscript",toggles:!0,type:"rich-text-editor-button"}}},{key:"scriptButtonGroup",get:function(){return{type:"button-group",buttons:[this.subscriptButton,this.superscriptButton]}}},{key:"symbolButton",get:function(){return{symbolTypes:["symbols"],type:"rich-text-editor-symbol-picker"}}},{key:"emojiButton",get:function(){return{type:"rich-text-editor-emoji-picker"}}},{key:"imageButton",get:function(){return{type:"rich-text-editor-image"}}},{key:"insertButtonGroup",get:function(){return{type:"button-group",buttons:[this.imageButton,this.symbolButton]}}},{key:"orderedListButton",get:function(){return{command:"insertOrderedList",icon:"editor:format-list-numbered",label:"Ordered List",toggles:!0,type:"rich-text-editor-button"}}},{key:"unorderedListButton",get:function(){return{command:"insertUnorderedList",icon:"editor:format-list-bulleted",label:"Unordered List",toggles:!0,type:"rich-text-editor-button"}}},{key:"blockquoteButton",get:function(){return{command:"formatBlock",commandVal:"blockquote",label:"Blockquote",icon:"editor:format-quote",shortcutKeys:"ctrl+'",type:"rich-text-editor-button"}}},{key:"indentButton",get:function(){return{command:"indent",icon:"editor:format-indent-increase",label:"Increase Indent",shortcutKeys:"ctrl+]",type:"rich-text-editor-button"}}},{key:"outdentButton",get:function(){return{command:"outdent",icon:"editor:format-indent-decrease",label:"Decrease Indent",shortcutKeys:"ctrl+[",type:"rich-text-editor-button"}}},{key:"listIndentButtonGroup",get:function(){return{type:"button-group",buttons:[this.orderedListButton,this.unorderedListButton,this.blockquoteButton,this.indentButton,this.outdentButton]}}},{key:"saveButton",get:function(){return{command:"save",icon:"save",label:"Save",type:"rich-text-editor-button"}}},{key:"closeButton",get:function(){return{command:"cancel",icon:"close",label:"Cancel",type:"rich-text-editor-button"}}},{key:"saveCloseButtonGroup",get:function(){return{type:"button-group",buttons:[this.saveButton]}}},{key:"sourceButton",get:function(){return{type:"rich-text-editor-source-code"}}},{key:"sourceButtonGroup",get:function(){return{type:"button-group",buttons:[this.sourceButton]}}},{key:"defaultConfig",get:function(){return[this.historyButtonGroup,this.basicInlineButtonGroup,this.linkButtonGroup,this.clipboardButtonGroup,this.scriptButtonGroup,this.insertButtonGroup,this.listIndentButtonGroup]}},{key:"miniConfig",get:function(){return[{type:"button-group",buttons:[this.boldButton,this.italicButton,this.removeFormatButton]},this.linkButtonGroup,this.scriptButtonGroup,{type:"button-group",buttons:[this.orderedListButton,this.unorderedListButton]}]}},{key:"miniTemplate",get:function(){return e.html(D||(D=P([' <div id="container">',"</div> "])),M(L(r.prototype),"toolbarTemplate",this))}},{key:"toolbarTemplate",get:function(){return M(L(r.prototype),"toolbarTemplate",this)}},{key:"render",value:function(){return this.toolbarTemplate}},{key:"connectedCallback",value:function(){M(L(r.prototype),"connectedCallback",this).call(this),window.RichTextEditorToolbars.push(this)}},{key:"disconnectedCallback",value:function(){var t=this;M(L(r.prototype),"disconnectedCallback",this).call(this),window.RichTextEditorToolbars=window.RichTextEditorToolbars.filter((function(e){return e!==t}))}},{key:"firstUpdated",value:function(t){var e=this;this.id||(this.id=this._generateUUID()),M(L(r.prototype),"firstUpdated",this).call(this,t),this.hasBreadcrumbs&&this._addBreadcrumbs(),this.__prompt=window.RichTextEditorPrompt.requestAvailability(),this.__prompt.addEventListener("open",(function(t){e.__promptOpen=!0})),this.__prompt.addEventListener("close",(function(t){e.__promptOpen=!1})),this.onmousedown=this._addHighlight,this.onkeydown=this._addHighlight}},{key:"updated",value:function(t){var e=this;M(L(r.prototype),"updated",this).call(this,t),t.forEach((function(t,n){"range"===n&&e._rangeChanged(),"editor"===n&&e._editorChange(),["editor","show","range"].includes(n)&&(e.hidden=e.disconnected),["breadcrumbs","sticky"].includes(n)&&e.breadcrumbs&&(e.breadcrumbs.sticky=e.sticky)}))}},{key:"controls",get:function(){var t=this.target?this.target.getAttribute("id"):void 0;return this.setAttribute("controls",t),t}},{key:"disconnected",get:function(){return"always"!=this.show&&("selection"!=this.show?!this.target:this.noSelection)}},{key:"noSelection",get:function(){return!this.range||this.range.collapsed}},{key:"observer",get:function(){return new MutationObserver(this._handleTargetMutation.bind(this))}},{key:"cancel",value:function(){this.dispatchEvent(new CustomEvent("cancel",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"close",value:function(){this.target=void 0,document.body.append(this),this.dispatchEvent(new CustomEvent("close",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"_editorChanged",value:function(){this.dispatchEvent(new CustomEvent("editor-change",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}},{key:"getRange",value:function(){var t=function t(e){var n=e.parentNode;return n?t(n):e};try{this.range=t(this.target)?_.getRange(t(this.target)):void 0}catch(t){this.range=void 0}return this.range}},{key:"getSelection",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return getSelection()}))},{key:"updateRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.range;t&&(t.range||(t.range=e),this.range=t.range)}},{key:"_rangeChanged",value:function(t){this._updateButtonRanges(),this.dispatchEvent(new CustomEvent("range-changed",{bubbles:!0,composed:!0,cancelable:!0,detail:this}))}},{key:"clearToolbar",value:function(){M(L(r.prototype),"clearToolbar",this)&&M(L(r.prototype),"clearToolbar",this).call(this),this.clickableElements={}}},{key:"deregisterButton",value:function(t){var e=this;M(L(r.prototype),"deregisterButton",this)&&M(L(r.prototype),"deregisterButton",this).call(this,t),(t.tagsArray||[]).forEach((function(t){return delete e.clickableElements[t]}))}},{key:"registerButton",value:function(t){var e=this;M(L(r.prototype),"registerButton",this)&&M(L(r.prototype),"registerButton",this).call(this,t),"paste"!==t.command||navigator.clipboard?(t.__toolbar=this,t.disabled=!this.target,(t.tagsArray||[]).forEach((function(n){return e.clickableElements[n]=function(e){return t.tagClickCallback(e)}}))):t.remove()}},{key:"_addBreadcrumbs",value:function(){this.breadcrumbs||(this.breadcrumbs=document.createElement("rich-text-editor-breadcrumbs"),document.body.appendChild(this.breadcrumbs)),this.breadcrumbs.label=this.breadcrumbsLabel}},{key:"_generateUUID",value:function(){var t=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return"rte-"+"ss-s-s-s-sss".replace(/s/g,t)}},{key:"_handleButtonUpdate",value:function(t){M(L(r.prototype),"_handleButtonUpdate",this)&&M(L(r.prototype),"_handleButtonUpdate",this).call(this,t)}},{key:"_updateButtonRanges",value:function(){var t=this;if(this.range&&this.target&&this.rangeNodeOrParentNode(this.range)&&this.target.contains(this.rangeNodeOrParentNode(this.range))){var e=[];this.rangeNodeOrParentNode(this.range)!==this.target&&function n(r){"rich-text-editor-highlight"!==r.tagName.toLowerCase()&&e.push(r),r.parentNode&&r.parentNode!==t.target&&n(r.parentNode)}(this.rangeNodeOrParentNode(this.range)),e.push({nodeName:this.breadcrumbsSelectAllLabel,selectAll:this.target}),this.selectedNode=e[0],this.selectionAncestors=e.reverse(),(this.buttons||[]).forEach((function(e){e.range=void 0,e.range=t.range,e.selectedNode=t.selectedNode,e.selectionAncestors=t.selectionAncestors})),this.breadcrumbs&&(this.breadcrumbs.selectionAncestors=this.selectionAncestors,this.breadcrumbs.hidden=this.disconnected,this.breadcrumbs.__target=this.__target)}}},{key:"cancelEdits",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.target;this.revertTarget(t),this.target(editor,!1)}},{key:"enabledTargetHandlers",get:function(){return{keydown:this._removeHighlight.bind(this),keypress:this._handleTargetKeypress.bind(this),mousedown:this._removeHighlight.bind(this)}}},{key:"enableEditing",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.target,n=this.enabledTargetHandlers;!e||e.hidden||e.disabled||(e.makeSticky(this.sticky),e.parentNode.insertBefore(this,e),e.setAttribute("contenteditable","true"),Object.keys(n).forEach((function(t){return e.removeEventListener(t,n[t])})),this.setCanceledEdits(),this.updateRange(e),this.observeChanges(!0),this.getRoot(e).onselectionchange=function(n){t.__promptOpen||t.updateRange(e)},this.dispatchEvent(new CustomEvent("enabled",{bubbles:!0,composed:!0,cancelable:!0,detail:(this.target.innerHTML||"").replace(/<!--[^(-->)]*-->/g,"").trim()})))}},{key:"disableEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.target,e=this.enabledTargetHandlers,n=this.getRange();t&&(n&&n.collapse(),this.__highlight.emptyContents(),this.getRoot(t).onselectionchange=void 0,this.observeChanges(!1),this.__source&&this.__source.toggle(!1),t.removeAttribute("contenteditable"),Object.keys(e).forEach((function(n){return t.removeEventListener(n,e[n])})),t.makeSticky(!1),this.dispatchEvent(new CustomEvent("disabled",{bubbles:!0,composed:!0,cancelable:!0,detail:(this.target.innerHTML||"").replace(/<!--[^(-->)]*-->/g,"").trim()})))}},{key:"insertNew",value:function(t){var e=document.createElement("rich-text-editor");t.parentNode.insertBefore(e,t),e.appendChild(t)}},{key:"observeChanges",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?this.observer.observe(this.target,{attributes:!1,childList:!0,subtree:!0,characterData:!1}):this.observer&&this.observer.disconnect}},{key:"revertTarget",value:function(){arguments.length>0&&void 0!==arguments[0]||this.target,this.target&&(this.target.innerHTML=this.__canceledEdits)}},{key:"sanitizeHTML",value:function(t){if(t){var e="<body(.*\n)*>(.*\n)*</body>";return t.match(e)&&t.match(e).length>0&&(t=t.match(e)[0].replace(/<\?body(.*\n)*\>/i)),t}}},{key:"setCanceledEdits",value:function(t){this.__canceledEdits=t||(this.target&&this.target.innerHTML?this.target.innerHTML:"")}},{key:"setTarget",value:function(t){var e=this,n=this.targetHandlers(t);if(t){var r=this.target;t.setAttribute("role","textbox"),r!==t&&(r&&this.unsetTarget(r),Object.keys(n).forEach((function(e){return t.addEventListener(e,n[e])})),this.getRoot(t).onselectionchange=function(n){e.__promptOpen||e.updateRange(t)},this.target=t,this.enableEditing(t))}this.updateRange(this.target),this.breadcrumbs&&(this.breadcrumbs.controls=this.controls,this.target&&this.target.parentNode.insertBefore(this.breadcrumbs,this.target.nextSibling)),this.buttons.forEach((function(t){"close"!==t.command&&(t.disabled=!e.target)})),this.range=void 0,this._rangeChanged()}},{key:"unsetTarget",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.target,e=this.targetHandlers(t);this.disableEditing(t),Object.keys(e).forEach((function(n){return t.removeEventListener(n,e[n])})),this.target=void 0}},{key:"targetEmpty",value:function(){return!this.target||!this.target.innerHTML||""==this.trimHTML(this.target)}},{key:"targetHandlers",value:function(t){var e=this;return{click:function(n){return e._handleTargetClick(t,n)},dblclick:function(n){return e._handleTargetDoubleClick(t,n)},focus:function(n){return e._handleTargetFocus(t,n)},keydown:function(t){return e._handleShortcutKeys(t)},paste:function(t){return e._handlePaste(t)}}}},{key:"targetHTML",get:function(){return this.target?this.outdentHTML(this.target.innerHTML):void 0}},{key:"htmlMatchesTarget",value:function(t){var e=t?this.outdentHTML(t):void 0,n=e?e.replace(/\s+/gm,""):void 0,r=this.targetHTML?this.targetHTML.replace(/\s+/gm,""):void 0;return n&&r&&r.localeCompare(n)}},{key:"_handleTargetDoubleClick",value:function(t,e){if(t&&!t.disabled&&this.target===t){var n=Object.keys(this.clickableElements||{}),r=e.target||e.srcElement||{tagName:""},o={detail:r},i=(r.tagName||"").toLowerCase();i&&n.includes(i)&&(e.preventDefault(),this.clickableElements[i](o),this.updateRange())}}},{key:"_handleTargetClick",value:function(t,e){if(t&&!t.disabled){if(this.target!==t)e.preventDefault(),this.setTarget(t);else{var n=Object.keys(this.clickableElements||{}),r=e.target||e.srcElement||{tagName:""},o={detail:r},i=(r.tagName||"").toLowerCase();i&&n.includes(i)&&(e.preventDefault(),this.clickableElements[i](o))}this.range=this.getRange(),this.updateRange()}}},{key:"_handleTargetFocus",value:function(t,e){this.__promptOpen||t.disabled||this.setTarget(t)}},{key:"_handleTargetKeypress",value:function(t){this.targetEmpty()&&t.key&&(this.innerHTML=t.key.replace(">","&gt;").replace("<","&lt;").replace("&","&amp;"),this.range=this.getRange(),this.range.selectNodeContents(this),this.range.collapse())}},{key:"_handleTargetMutation",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._handleTargetSelection(),(e||[]).forEach((function(e){"attributes"==e.type&&((target.disabled||target.hidden)&&target.conteneditable?(t.disableEditing(target),target.tabindex=-1):target.disabled||target.hidden||!target.conteneditable||(t.enableEditing(target),target.tabindex=0))}))}},{key:"_handleTargetSelection",value:function(t){this.__promptOpen||(this.range=this.getRange())}},{key:"_handlePaste",value:function(t){t.stopImmediatePropagation(),this.pasteFromClipboard()}},{key:"_addHighlight",value:function(){this.__highlight.hidden&&(this.range=this.getRange(),this.target&&"true"!=!this.target.getAttribute("contenteditable")&&this.__highlight.wrap(this.range||this.getRange()))}},{key:"_removeHighlight",value:function(){this.__highlight.unwrap(this.range||this.getRange())}}],[{key:"tag",get:function(){return"rich-text-editor-toolbar"}},{key:"miniStyles",get:function(){return[e.css(G||(G=P(["\n          :host {\n            position: relative;\n            height: 0;\n            margin: 0 auto;\n            padding: 0;\n            border: none;\n            background-color: none;\n          }\n          #container {\n            display: flex;\n            position: absolute;\n            bottom: 0;\n            margin: 0 auto;\n            padding: 0;\n            border: var(--rich-text-editor-border-width, 1px) solid\n              var(--rich-text-editor-border-color, #ddd);\n            background-color: var(\n              --rich-text-editor-bg,\n              var(--rich-text-editor-bg, #ffffff)\n            );\n          }\n        "])))]}},{key:"baseStyles",get:function(){return[].concat(q(M(L(r),"baseStyles",this)),q(m.RichTextStyles),[e.css(K||(K=P(["\n          :host {\n            border: var(--rich-text-editor-border-width, 1px) solid\n              var(--rich-text-editor-border-color, #ddd);\n            background-color: var(--rich-text-editor-bg, #ffffff);\n          }\n        "])))])}},{key:"styles",get:function(){return[].concat(q(this.baseStyles),q(M(L(r),"stickyStyles",this)))}},{key:"properties",get:function(){return E(E({},M(L(r),"properties",this)),{},{breadcrumbsLabel:{name:"breadcrumbsLabel",type:String,attribute:"breadcrumbs-label"},breadcrumbsSelectAllLabel:{name:"breadcrumbsSelectAllLabel",type:String,attribute:"breadcrumbs-select-all-label"},target:{name:"target",type:Object},id:{name:"id",type:String,attribute:"id",reflect:!0},savedSelection:{name:"savedSelection",type:Object},registered:{type:Boolean},selectedNode:{type:Object},selectionAncestors:{type:Array},show:{type:String,attribute:"show",reflect:!0},clickableElements:{name:"clickableElements",type:Object},__canceledEdits:{type:Object},__pasteDisabled:{name:"__pasteDisabled",type:Boolean,attribute:"paste-disabled",reflect:!0},__prompt:{type:Object},__promptOpen:{name:"__promptOpen",type:Boolean}})}}]),r}(r.RichTextEditorRangeBehaviors(g.SimpleToolbarBehaviors(t)))},Q=function(t){S(n,t);var e=N(n);function n(){return T(this,n),e.apply(this,arguments)}return n}(J(e.LitElement));window.customElements.define(Q.tag,Q);var W,X,Y,Z,tt=function(t){S(r,t);var n=N(r);function r(){var t;return T(this,r),(t=n.call(this)).sticky=!1,t.config=t.miniConfig,t}return j(r,[{key:"render",value:function(){return e.html($||($=P([" "," "])),M(L(r.prototype),"miniTemplate",this))}},{key:"updated",value:function(t){var e=this;M(L(r.prototype),"updated",this).call(this,t),t.forEach((function(t,n){"sticky"===n&&e.sticky&&(e.sticky=!1)}))}}],[{key:"tag",get:function(){return"rich-text-editor-toolbar-mini"}},{key:"styles",get:function(){return[].concat(q(M(L(r),"baseStyles",this)),q(M(L(r),"miniStyles",this)))}}]),r}(J(e.LitElement));window.customElements.define(tt.tag,tt);var et=function(t){S(r,t);var n=N(r);function r(){var t;return T(this,r),(t=n.call(this)).hidden=!0,t.sticky=!1,t.label="Select",t}return j(r,[{key:"_handleClick",value:function(t){t.selectAll?this.selectNodeContents(t.selectAll):this.selectNode(t),this.__target&&this.__target.focus()}},{key:"render",value:function(){var t=this;return e.html(W||(W=P(["\n      ",":\n      ","\n    "])),this.label,this.selectionAncestors?(this.selectionAncestors||[]).map((function(n,r){return e.html(X||(X=P(['\n              <button\n                class="','"\n                controls="','"\n                @click="','"\n                tabindex="0"\n              >\n                ',"\n              </button>\n              ","\n            "])),n.selectAll?"":"selectnode",t.controls,(function(e){return t._handleClick(n)}),n.nodeName.toLowerCase(),r+1>=(t.selectionAncestors||[]).length?"":e.html(Y||(Y=P([' <span class="divider"> &gt; </span> ']))))})):"")}}],[{key:"tag",get:function(){return"rich-text-editor-breadcrumbs"}},{key:"properties",get:function(){return{controls:{type:String},hidden:{type:Boolean,attribute:"hidden",reflect:!0},label:{type:String},sticky:{type:Boolean,reflect:!0},selectionAncestors:{type:Array},__target:{type:Object}}}},{key:"styles",get:function(){return[].concat(q(m.RichTextToolbarStyles),[e.css(Z||(Z=P(["\n        :host {\n          display: block;\n          background-color: var(--rich-text-editor-bg, #ffffff);\n          color: var(--rich-text-editor-button-color #444);\n          border: var(--rich-text-editor-border-width, 1px) solid var(--rich-text-editor-border-color, #ddd);\n          padding: 3px 10px;\n        }\n        :host([sticky]) {\n          position: sticky;\n          bottom: 0;\n        }\n        .selectednode {\n          background-color: var(--rich-text-editor-button-bg, #ffffff);\n        }\n        button {\n          display: inline-block;\n          text-align: center;\n          min-width: 25px;\n          margin: 0;\n          padding: 2px 5px;\n        }\n        .selectNode {\n          font-family: monospace;\n        }\n      "])))])}}]),r}(r.RichTextEditorRangeBehaviors(e.LitElement));window.customElements.define(et.tag,et);var nt,rt,ot=function(t){S(n,t);var e=N(n);function n(){return T(this,n),e.call(this)}return j(n,[{key:"render",value:function(){return M(L(n.prototype),"render",this).call(this)}},{key:"hasBreadcrumbs",get:function(){return!0}}],[{key:"tag",get:function(){return"rich-text-editor-toolbar-full"}},{key:"styles",get:function(){return[].concat(q(M(L(n),"baseStyles",this)),q(M(L(n),"stickyStyles",this)))}},{key:"properties",get:function(){return E({},M(L(n),"properties",this))}}]),n}(J(e.LitElement));window.customElements.define(ot.tag,ot);var it=function(t){return function(t){S(r,t);var n=N(r);function r(){var t;return T(this,r),(t=n.call(this)).placeholder="Click to edit",t.toolbarId="",t.type="rich-text-editor-toolbar",t.id="",t.range=void 0,t.disabled=!1,t.__focused=!1,t.__hovered=!1,t.editing=!1,t.contenteditable=!1,t.setAttribute("tabindex",1),t.addEventListener("click",t._handleClick),t}return j(r,[{key:"render",value:function(){var t=this;return e.html(nt||(nt=P([' <div\n        id="container"\n        @focus="','"\n        @blur="','"\n        @mouseover="','"\n        @mouseout="','"\n      >\n        <slot></slot>\n      </div>'])),(function(e){return t.__focused=!0}),(function(e){return t.__focused=!1}),(function(e){return t.__hovered=!0}),(function(e){return t.__hovered=!1}))}},{key:"isEmpty",get:function(){return!this.innerHTML||""==this.innerHTML.replace(/<!--[^(-->)]*-->/g,"").replace(/[\s\t\r\n]/gim,"")}},{key:"firstUpdated",value:function(){M(L(r.prototype),"firstUpdated",this)&&M(L(r.prototype),"firstUpdated",this).call(this),this.isEmpty&&this.rawhtml?this.innerHTML=this.rawhtml.trim():this.isEmpty&&(this.innerHTML="")}},{key:"updated",value:function(t){var e=this;M(L(r.prototype),"updated",this).call(this,t),t.forEach((function(t,n){"rawhtml"===n&&e.rawhtml&&(e.innerHTML=e.rawhtml.trim()),"contenteditable"===n&&e._contenteditableChange()})),this.innerHTML||(this.innerHTML="")}},{key:"focus",value:function(){this.disabled||(this.__focused=!0),this.dispatchEvent(new CustomEvent("focus",{bubbles:!0,composed:!0,cancelable:!0,detail:this.querySelector("*")}))}},{key:"makeSticky",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?this.classList.remove("heightmax"):this.classList.add("heightmax")}},{key:"_contenteditableChange",value:function(){this.dispatchEvent(new CustomEvent("contenteditable-change",{bubbles:!0,composed:!0,cancelable:!0,detail:this}))}},{key:"_handleClick",value:function(t){var e=this;if(t.preventDefault(),!this.disabled&&!this.contenteditable&&!this.__toolbar){var n,r=this.toolbarId?(window.RichTextEditorToolbars||[]).filter((function(t){return t.id===e.toolbarId})):[];0===r.length&&(r=this.type?(window.RichTextEditorToolbars||[]).filter((function(t){return t.type===e.type})):[]),0===r.length&&(r=window.RichTextEditorToolbars),r[0]?n=r[0]:0===r.length&&(n=document.createElement(this.type||"rich-text-editor-toolbar")),this.__toolbar=n,this.disabled||this.__toolbar.setTarget(this)}}}],[{key:"styles",get:function(){return[].concat(q(V),[e.css(rt||(rt=P(['\n          :host {\n            display: block;\n          }\n          :host([hidden]) {\n            display: none;\n          }\n          :host([disabled]) {\n            cursor: not-allowed;\n          }\n          :host(:empty) {\n            opacity: 0.7;\n          }\n          :host(:focus) {\n            outline: none;\n          }\n\n          :host(.heightmax[contenteditable="true"]) {\n            max-height: calc(100vh - 200px);\n            overflow-y: scroll;\n          }\n\n          #container,\n          #wysiwyg {\n            display: block;\n            width: 100%;\n          }\n          #source,\n          #wysiwyg {\n            margin: 0;\n            padding: 0;\n            min-height: var(--rich-text-editor-min-height, 20px);\n            cursor: pointer;\n            outline: none;\n            flex: 1 1 100%;\n            width: 100%;\n          }\n          :host(:empty) {\n            min-height: 20px;\n          }\n          :host(:empty)::after {\n            display: block;\n            content: attr(aria-placeholder);\n          }\n\n          :host(:hover),\n          :host(:focus-within) {\n            opacity: 1;\n            outline: var(--rich-text-editor-border-width, 1px) dotted\n              var(--rich-text-editor-focus-color, currentColor);\n          }\n          :host([disabled]),\n          :host([view-source]) {\n            outline: none !important;\n          }\n\n          #source:hover,\n          #source:focus-within {\n            outline: var(--rich-text-editor-border-width, 1px) dotted\n              var(--rich-text-editor-focus-color, currentColor);\n          }\n          :host([contenteditable="true"][view-source]) #container {\n            display: flex;\n            align-items: stretch;\n            justify-content: space-between;\n            width: 100%;\n          }\n          :host([contenteditable="true"][view-source]) #source,\n          :host([contenteditable="true"][view-source]) #wysiwyg {\n            resize: horizontal;\n            overflow: auto;\n            flex: 1 1 auto;\n            width: 50%;\n          }\n          :host([contenteditable="true"][view-source]) #source {\n            min-width: 300px;\n          }\n          :host([contenteditable="true"][view-source]) #wysiwyg {\n            cursor: not-allowed;\n            margin-right: 10px;\n            width: calc(50% - 10px);\n          }\n          ::slotted(*:first-child) {\n            margin-top: 0px;\n          }\n          ::slotted(*:last-child) {\n            margin-bottom: 0px;\n          }\n        '])))])}},{key:"properties",get:function(){return E(E({},M(L(r),"properties",this)),{},{id:{name:"id",type:String,reflect:!0,attribute:"id"},contenteditable:{name:"contenteditable",type:Boolean,reflect:!0,attribute:"contenteditable"},disabled:{name:"disabled",type:Boolean,attribute:"disabled",reflect:!0},disableHover:{name:"disableHover",type:Boolean,attribute:"disable-hover"},placeholder:{name:"placeholder",type:String,reflect:!0,attribute:"aria-placeholder"},toolbarId:{name:"toolbarId",type:String,reflect:!0,attribute:"toolbar-id"},range:{name:"range",type:Object,attribute:"range"},rawhtml:{type:String,attribute:"rawhtml"},type:{name:"type",type:String,reflect:!0,attribute:"type"},viewSource:{type:Boolean,attribute:"view-source",reflect:!0},__codeEditorValue:{type:String},__needsUpdate:{type:Boolean},__focused:{type:Boolean},__hovered:{type:Boolean}})}},{key:"tag",get:function(){return"rich-text-editor"}}]),r}(t)},at=function(t){S(n,t);var e=N(n);function n(){return T(this,n),e.apply(this,arguments)}return n}(it(e.LitElement));window.customElements.define(at.tag,at),t.RichTextEditor=at,t.RichTextEditorBehaviors=it,Object.defineProperty(t,"__esModule",{value:!0})}));
