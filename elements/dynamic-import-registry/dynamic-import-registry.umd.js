!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).DynamicImportRegistry={})}(this,function(t){"use strict";function e(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function c(t,e,n){return(c=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function u(t){var e="function"==typeof Map?new Map:void 0;return(u=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return c(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,t)})(t)}function s(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}window.DynamicImportRegistry=window.DynamicImportRegistry||{},window.DynamicImportRegistry.requestAvailability=function(){return window.DynamicImportRegistry.instance||(window.DynamicImportRegistry.instance=document.createElement("dynamic-import-registry"),document.body.appendChild(window.DynamicImportRegistry.instance)),window.DynamicImportRegistry.instance};var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(l,u(HTMLElement));var n,c,f=(n=l,c=a(),function(){var t,e=i(n);if(c){var r=i(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return s(this,t)});function l(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=f.call(this)).list={},t.__loaded={},t.basePath=t.pathFromUrl(decodeURIComponent("undefined"==typeof document?new(require("url").URL)("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("dynamic-import-registry.umd.js",document.baseURI).href))+"../../",window.WCAutoloadBasePath&&(t.basePath=window.WCAutoloadBasePath),t}return r(l,null,[{key:"tag",get:function(){return"dynamic-import-registry"}}]),r(l,[{key:"connectedCallback",value:function(){window.addEventListener("dynamic-import-registry--register",this.registerDefinitionEvent.bind(this))}},{key:"disconnectedCallback",value:function(){window.removeEventListener("dynamic-import-registry--register",this.registerDefinitionEvent.bind(this))}},{key:"register",value:function(t){t.tag&&t.path?this.list[t.tag]||(this.list[t.tag]=t.path):console.warn("DynamicImportRegistry: registration requires tag and path be set")}},{key:"registerDefinitionEvent",value:function(t){t.detail.tag&&t.detail.path&&this.register(t.detail)}},{key:"loadDefinition",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(e){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=e.toLowerCase(),window.customElements.get(e)||!this.list[e]||this.__loaded[e]){t.next=12;break}return this.__loaded[e]=!0,t.prev=3,t.next=6,import("".concat(this.basePath).concat(this.list[e])).then(function(t){n.dispatchEvent(new CustomEvent("dynamic-import-registry-loaded",{detail:{tag:e,path:n.list[e],module:t}}))});case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(3),console.warn(t.t0),this.dispatchEvent(new CustomEvent("dynamic-import-registry-failure",{detail:{tag:e,path:this.list[e],module:null}}));case 12:case"end":return t.stop()}},t,this,[[3,8]])}),function(){var n=this,r=arguments;return new Promise(function(i,o){var a=t.apply(n,r);function c(t){e(a,i,o,c,u,"next",t)}function u(t){e(a,i,o,c,u,"throw",t)}c(void 0)})});return function(t){return n.apply(this,arguments)}}()},{key:"pathFromUrl",value:function(t){return t.substring(0,t.lastIndexOf("/")+1)}}]),l}();window.customElements.define(f.tag,f),t.DynamicImportRegistry=f,Object.defineProperty(t,"__esModule",{value:!0})});
