!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@lrnwebcomponents/dynamic-import-registry/dynamic-import-registry.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/dynamic-import-registry/dynamic-import-registry.js"],e):e((t=t||self).WcAutoload={})}(this,function(t){"use strict";function e(t,e,n,o,r,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(o,r)}function n(t){return function(){var n=this,o=arguments;return new Promise(function(r,i){var a=t.apply(n,o);function u(t){e(a,r,i,u,c,"next",t)}function c(t){e(a,r,i,u,c,"throw",t)}u(void 0)})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function l(t,e,n){return(l=s()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var r=new(Function.bind.apply(t,o));return n&&c(r,n.prototype),r}).apply(null,arguments)}function d(t){var e="function"==typeof Map?new Map:void 0;return(d=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return l(t,arguments,u(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),c(o,t)})(t)}function f(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){var e=s();return function(){var n,o=u(t);if(e){var r=u(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return f(this,n)}}window.WCAutoload=window.WCAutoload||{},window.WCAutoload.requestAvailability=function(){return window.WCAutoload.instance||(window.WCAutoload.instance=document.createElement("wc-autoload"),document.body.appendChild(window.WCAutoload.instance)),window.WCAutoload.instance};var p=function(){var t=n(regeneratorRuntime.mark(function t(e,n,o){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<o)){t.next=16;break}return t.prev=2,t.next=5,fetch(e,n);case 5:return t.abrupt("return",t.sent);case 8:if(t.prev=8,t.t0=t.catch(2),!(r+1===o)){t.next=13;break}throw t.t0;case 13:r++,t.next=1;break;case 16:case"end":return t.stop()}},t,null,[[2,8]])}));return function(e,n,o){return t.apply(this,arguments)}}();window.WCAutoload.process=function(t){return new Promise(function(t,e){setTimeout(function(){var e=window.WCAutoload.requestAvailability();e.loaded=!0;var o={};if(window.WCAutoloadRegistryFileProcessed){var r=document;e.target&&(r=e.target,e.processNewElement(r)),r.querySelectorAll("*").forEach(function(t){t.tagName&&!o[t.tagName]&&(e.processNewElement(t),o[t.tagName]=t.tagName)}),t("autoloader already processed")}else setTimeout(n(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(window.WCAutoloadBasePath&&(e.registry.basePath=window.WCAutoloadBasePath),!window.WCAutoloadRegistryFile||window.WCAutoloadRegistryFileProcessed){n.next=4;break}return n.next=4,p(window.WCAutoloadRegistryFile,{},3).then(function(t){return t.json()}).then(function(t){window.WCAutoloadRegistryFileProcessed=!0,window.WCAutoloadRegistry=t});case 4:if(window.WCAutoloadRegistry)for(r in window.WCAutoloadRegistry)e.registry.register({tag:r,path:window.WCAutoloadRegistry[r]});i=document,e.target&&(i=e.target,e.processNewElement(i)),i.querySelectorAll("*").forEach(function(t){t.tagName&&!o[t.tagName]&&(e.processNewElement(t),o[t.tagName]=t.tagName)}),t("autoloader processed on the fly");case 9:case"end":return n.stop()}},n)})),0)},0)})},window.addEventListener("load",window.WCAutoload.process),window.WCAutoload.postLoaded=function(t){setTimeout(function(){var e=window.WCAutoload.requestAvailability();e.loaded&&document.querySelectorAll(t.detail.tag).length>0&&e.registry.loadDefinition(t.detail.tag)},0)},window.addEventListener("dynamic-import-registry--new-registration",window.WCAutoload.postLoaded);var y=function(t){a(n,d(HTMLElement));var e=w(n);function n(){var t;return o(this,n),(t=e.call(this)).loader=window.WCAutoload.requestAvailability(),t}return i(n,null,[{key:"tag",get:function(){return"wc-registry"}}]),i(n,[{key:"connectedCallback",value:function(){var t=this;setTimeout(function(){if(t.children.length>0&&"TEMPLATE"==t.children[0].tagName)try{var e=JSON.parse(t.children[0].content.textContent);for(var n in e)t.loader.registry.register({tag:n,path:e[n]})}catch(t){console.warn(t)}},0)}}]),n}();customElements.define(y.tag,y);var g=function(t){a(n,d(HTMLElement));var e=w(n);function n(){var t;return o(this,n),(t=e.call(this)).loaded=!1,t.registry=window.DynamicImportRegistry.requestAvailability(),t.options={childList:!0,subtree:!0},t}return i(n,null,[{key:"tag",get:function(){return"wc-autoload"}}]),i(n,[{key:"connectedCallback",value:function(){var t=this;this._mutationObserver=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){t.processNewElement(e)})})}),window.WCAutoloadOptions&&(this.options=window.WCAutoloadOptions),setTimeout(function(){window.WCAutoloadTarget?t.target=window.WCAutoloadTarget:t.target=document.body,t._mutationObserver.observe(t.target,t.options)},0)}},{key:"disconnectedCallback",value:function(){this._mutationObserver.disconnect()}},{key:"processNewElement",value:function(t){t.tagName&&t.tagName.includes("-")&&"DYNAMIC-IMPORT-REGISTRY"!=t.tagName&&"WC-AUTOLOAD"!=t.tagName&&this.registry.loadDefinition(t.tagName)}}]),n}();window.customElements.define(g.tag,g),t.WcAutoload=g,Object.defineProperty(t,"__esModule",{value:!0})});
